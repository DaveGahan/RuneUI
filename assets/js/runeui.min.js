var GUI={DBentry:["","",""],DBupdate:0,activePlayer:"",browsemode:"file",checkvol:0,currentDBpos:[0,0,0,0,0,0,0,0,0,0,0],currentDBpath:["","","","","","","","","","",""],currentalbum:null,currentknob:null,currentpath:"",currentsong:null,json:0,libraryhome:"",forceGUIupdate:!1,maxvol:100,minvol:0,mode:"websocket",noticeUI:{},playlist:null,plugin:"",state:"",old_state:"none",stepVolumeDelta:0,stepVolumeInt:0,stream:"",visibility:"visible",vol_changed_local:0,volume:null,clientUUID:null};function generateUUID(){var t=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var a=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"==e?a:3&a|8).toString(16)})}function sendCmd(e){$.ajax({type:"GET",url:"/command/?cmd="+e+"&clientUUID="+GUI.clientUUID,cache:!1})}function checkWebSocket(){return window.WebSocket?"websocket":"longpolling"}function checkWorkers(){return!!(window.Worker&&window.Blob||Modernizr.webworkers&&Modernizr.blobconstructor)}function parsePath(e){var a=e&&e.length?e.lastIndexOf("/"):0,t="";return a&&-1!==a&&(t=e.slice(0,a)),t}var idleTime=0,viewScreenSaver=0,widthScreenSaver=0,isLocalHost=0,SStime=-1;function timerIncrement(){$("#section-index").length&&"play"===GUI.state?idleTime+=1:idleTime=0,SStime<idleTime&&($(".tab-content").hide("slow"),$(".screen-saver-content").show("slow"),$("#menu-bottom").hide("slow"),$("#menu-top").hide("slow"),viewScreenSaver=1)}function refreshTimer(e,a,t){var s=$("#countdown-display");s.countdown("destroy"),s.countdown({since:"stop"!==t||void 0!==t?-e:0,compact:!0,format:"MS"}),"play"!==t&&s.countdown("pause");var o=$("#countdown-display-ss");o.countdown("destroy"),o.countdown({since:"stop"!==t||void 0!==t?-e:0,compact:!0,format:"MS"}),"play"!==t&&o.countdown("pause")}function refreshKnob(){window.clearInterval(GUI.currentKnob);var e=10*parseInt(GUI.json.song_percent),a=parseInt(GUI.json.time),t=parseInt(1e3/a),s=$("#time");s.val(e,!1).trigger("update"),"play"===GUI.state&&(GUI.currentKnob=setInterval(function(){e+="visible"!==GUI.visibility?t:1,s.val(e,!1).trigger("update")},a))}function timeConvert(e){var a=Math.floor(e/60);return(a<10?"0"+a:a)+":"+((e-=60*a)<10?"0"+e:e)}function timeConvert2(e){var a=Math.floor(e/3600),t=Math.floor((e-3600*a)/60);return e=Math.floor(e-3600*a-60*t),0<a?(a<10&&(a="0"+a),a+=":"):a="",t<10&&(t="0"+t),e<10&&(e="0"+e),a+t+":"+e}function timeConvert3(e){var a=Math.floor(e/3600),t=Math.floor((e-3600*a)/60);return e=Math.floor(e-3600*a-60*t),0<a?(a<10&&(a="0"+a+"h "),a+="h "):a="",t<10&&(t="0"+t),e<10&&(e="0"+e),a+t+"m "+e+"s"}function countdownRestart(e){$("#countdown-display").countdown("destroy").countdown({since:-e,compact:!0,format:"MS"}),$("#countdown-display-ss").countdown("destroy").countdown({since:-e,compact:!0,format:"MS"})}function reset_vol_changed_local(){GUI.vol_changed_local=0}function setvol(e){GUI.volume=e,$("#volumemute").removeClass("btn-primary"),sendCmd("setvol "+e),0===GUI.vol_changed_local&&(setInterval(reset_vol_changed_local,5e3),GUI.vol_changed_local=1)}function volumeStepCalc(a){var t=0;GUI.volume=parseInt($("#volume").val());var e=function(e){t++,"up"===a?GUI.stepVolumeDelta=parseInt(GUI.volume)+t:"dn"===a&&(GUI.stepVolumeDelta=parseInt(GUI.volume)-t),$("#volume").val(GUI.stepVolumeDelta).trigger("change")};e(),GUI.stepVolumeInt=window.setInterval(function(){e()},200)}function volumeStepSet(){window.clearInterval(GUI.stepVolumeInt),setvol(GUI.stepVolumeDelta)}function customScroll(e,a,t){void 0===t&&(t=500);var s=parseInt($(window).height()/2),o=$(window).scrollTop(),i=0,n=0;"db"===e?n=i=parseInt(49*a-s):"pl"===e&&(n=(o<(i=parseInt(49*(a+2)-s))?"+":"-")+"="+(n=Math.abs(i-o))+"px",$("#playlist-entries").find("li").eq(a).addClass("active")),$.scrollTo(0<i?n:0,t)}function randomScrollPL(){var e=$(".playlist li").size();customScroll("pl",1+Math.floor(Math.random()*e))}function randomScrollDB(){var e=$(".database li").size();customScroll("db",1+Math.floor(Math.random()*e))}function toggleLoader(e){"close"===e?$("#loader").addClass("hide"):$("#section-dev").length?($("#loader").addClass("hide"),new PNotify({title:"Warning",text:"The loading layer (spinning arrows) points to a socket error",icon:"fa fa-exclamation-circle"})):$("#loader").removeClass("hide")}function customNotify(e){"kernelswitch"===e.custom&&(void 0!==GUI.noticeUI.kernelswitch&&GUI.noticeUI.kernelswitch.remove(),GUI.noticeUI.kernelswitch=new PNotify({title:"title"in e?e.title:"[missing title]",text:"text"in e?e.text:"[missing text]",icon:"fa fa-refresh",hide:!1,confirm:{confirm:!0,buttons:[{text:e.btntext,addClass:"btn-default btn-block  uppercase",click:function(){$.post("/settings/",{syscmd:"reboot"}),toggleLoader()}},{text:"Cancel",addClass:"hide"}]},buttons:{closer:!1,sticker:!1}}))}function renderMSG(e){var a=e[0];if("custom"in a&&null!==a.custom)customNotify(a);else{var t={title:"title"in a?a.title:"[missing title]",text:"text"in a?a.text:"[missing text]",icon:void 0===a.icon?"fa fa-check":a.icon,opacity:void 0===a.opacity?.9:a.opacity,hide:void 0===a.hide&&void 0===a.permanotice,buttons:{closer:void 0===a.permanotice,sticker:void 0===a.permanotice},delay:void 0===a.delay?8e3:a.delay,mouse_reset:!1};"permanotice"in a?void 0===GUI.noticeUI[a.permanotice]?GUI.noticeUI[a.permanotice]=new PNotify(t):"permaremove"in a?(GUI.noticeUI[a.permanotice].remove(),GUI.noticeUI[a.permanotice]=void 0):GUI.noticeUI[a.permanotice].open():new PNotify(t)}}function sortOrder(e){var a=$("#"+e).index();sendCmd("moveid "+(e=parseInt(e.replace("pl-","")))+" "+a)}function loadingSpinner(e,a){"hide"===a?("db"===e&&$("#spinner-db").addClass("hide"),"pl"===e&&$("#spinner-pl").addClass("hide")):("db"===e&&$("#spinner-db").removeClass("hide"),"pl"===e&&$("#spinner-pl").removeClass("hide"))}function setPlaybackSource(){var e=GUI.libraryhome.ActivePlayer;$("#overlay-playsource-open button").text(e),$("#overlay-playsource a").addClass("inactive");var a=e.toLowerCase();$("#playsource-"+a).removeClass("inactive"),"Spotify"===e||"Airplay"===e?($("#volume").trigger("configure",{readOnly:!0,fgColor:"#1A242F"}).css({color:"#1A242F"}),$("#volume-knob").addClass("nomixer"),$("#volume-knob button").prop("disabled",!0),$("#single").addClass("disabled")):($("#volume").trigger("configure",{readOnly:!1,fgColor:"#0095D8"}).css({color:"#0095D8"}),$("#volume-knob").removeClass("nomixer"),$("#volume-knob button").prop("disabled",!1),$("#single").removeClass("disabled")),$("#playlist-entries").removeClass(function(e,a){return(a.match(/(^|\s)playlist-\S+/g)||[]).join(" ")}).addClass("playlist-"+a),$("#pl-manage").removeClass(function(e,a){return(a.match(/(^|\s)pl-manage-\S+/g)||[]).join(" ")}).addClass("pl-manage-"+a)}function chkKey(e){return void 0!==e&&""!==e}function renderLibraryHome(){loadingSpinner("db"),$("#database-entries").addClass("hide"),$("#db-level-up").addClass("hide"),$("#db-homeSetup").removeClass("hide").removeClass("btn-primary").addClass("btn-default"),$("#home-blocks").removeClass("hide");var e=GUI.libraryhome,a=0,t="",s='<div class="col-lg-3 col-md-4 col-sm-6">',o="</div>",i="",n="Spotify"===e.ActivePlayer||"Airplay"===e.ActivePlayer;for(t=isLocalHost?"":'<div class="col-sm-12"><h1 class="txtmid">Browse your library</h1></div>',setPlaybackSource(),n&&(i=" inactive"),a=0;bookmark=e.bookmarks[a];a+=1)t+=s+'<div id="home-bookmark-'+bookmark.id+'" class="home-block home-bookmark'+i+'" data-path="'+bookmark.path+'"><i class="fa fa-star"></i><h3>'+bookmark.name+"</h3>bookmark</div>"+o;chkKey(e.networkMounts)&&(isLocalHost?0===e.networkMounts?t+=n?s+'<div id="home-nas" class="home-block inactive"><i class="fa fa-sitemap"></i><h3>Network mounts (0)</h3></div>'+o:s+'<a class="home-block'+i+'" href="/sources/add/"><i class="fa fa-sitemap"></i><h3>Network mounts (0)</h3></a>'+o:t+=s+'<div id="home-nas" class="home-block'+i+'" data-path="NAS"><i class="fa fa-sitemap"></i><h3>Network mounts ('+e.networkMounts+")</h3></div>"+o:0===e.networkMounts?t+=n?s+'<div id="home-nas" class="home-block inactive"><i class="fa fa-sitemap"></i><h3>Network mounts (0)</h3>network attached storages</div>'+o:s+'<a class="home-block'+i+'" href="/sources/add/"><i class="fa fa-sitemap"></i><h3>Network mounts (0)</h3>click to add some</a>'+o:t+=s+'<div id="home-nas" class="home-block'+i+'" data-path="NAS"><i class="fa fa-sitemap"></i><h3>Network mounts ('+e.networkMounts+")</h3>network attached storages</div>"+o),chkKey(e.localStorages)&&(isLocalHost?0===e.localStorages?t+="":t+=s+'<div id="home-local" class="home-block'+i+'" data-path="LocalStorage"><i class="fa fa-hdd-o"></i><h3>LocalStorage ('+e.localStorages+")</h3></div>"+o:0===e.localStorages?t+="":t+=s+'<div id="home-local" class="home-block'+i+'" data-path="LocalStorage"><i class="fa fa-hdd-o"></i><h3>LocalStorage ('+e.localStorages+")</h3>locally stored music</div>"+o),chkKey(e.USBMounts)&&(isLocalHost?0===e.USBMounts?t+=n?s+'<div id="home-usb" class="home-block inactive"><i class="fa fa-hdd-o"></i><h3>USB storage (0)</h3></div>'+o:s+'<a id="home-usb" class="home-block'+i+'" href="/sources"><i class="fa fa-hdd-o"></i><h3>USB storage (0)</h3></a>'+o:t+=s+'<div id="home-usb" class="home-block'+i+'" data-path="USB"><i class="fa fa-hdd-o"></i><h3>USB storage ('+e.USBMounts+")</h3></div>"+o:0===e.USBMounts?t+=n?s+'<div id="home-usb" class="home-block inactive"><i class="fa fa-hdd-o"></i><h3>USB storage (0)</h3>no USB storage plugged</div>'+o:s+'<a id="home-usb" class="home-block'+i+'" href="/sources"><i class="fa fa-hdd-o"></i><h3>USB storage (0)</h3>no USB storage plugged</a>'+o:t+=s+'<div id="home-usb" class="home-block'+i+'" data-path="USB"><i class="fa fa-hdd-o"></i><h3>USB storage ('+e.USBMounts+")</h3>USB attached drives</div>"+o),chkKey(e.webradio)&&(isLocalHost?0===e.webradio?t+=n?s+'<div id="home-webradio" class="home-block inactive"><i class="fa fa-microphone"></i><h3>My Webradios (0)</h3></div>'+o:s+'<a id="home-webradio" class="home-block'+i+'" href="#" data-toggle="modal" data-target="#modal-webradio-add"><i class="fa fa-microphone"></i><h3>My Webradios (0)</h3></a>'+o:t+=s+'<div id="home-webradio" class="home-block'+i+'" data-path="Webradio"><i class="fa fa-microphone"></i><h3>My Webradios ('+e.webradio+")</h3></div>"+o:0===e.webradio?t+=n?s+'<div id="home-webradio" class="home-block inactive"><i class="fa fa-microphone"></i><h3>My Webradios (0)</h3>webradio local playlists</div>'+o:s+'<a id="home-webradio" class="home-block'+i+'" href="#" data-toggle="modal" data-target="#modal-webradio-add"><i class="fa fa-microphone"></i><h3>My Webradios (0)</h3>click to add some</a>'+o:t+=s+'<div id="home-webradio" class="home-block'+i+'" data-path="Webradio"><i class="fa fa-microphone"></i><h3>My Webradios ('+e.webradio+")</h3>webradio local playlists</div>"+o),t+=isLocalHost?s+'<div id="home-albums" class="home-block'+i+'" data-path="Albums" data-browsemode="album"><i class="fa fa-dot-circle-o"></i><h3>Albums</h3></div>'+o:s+'<div id="home-albums" class="home-block'+i+'" data-path="Albums" data-browsemode="album"><i class="fa fa-dot-circle-o"></i><h3>Albums</h3>browse MPD database by album</div>'+o,t+=isLocalHost?s+'<div id="home-artists" class="home-block'+i+'" data-path="Artists" data-browsemode="artist"><i class="fa fa-users"></i><h3>Artists</h3></div>'+o:s+'<div id="home-artists" class="home-block'+i+'" data-path="Artists" data-browsemode="artist"><i class="fa fa-users"></i><h3>Artists</h3>browse MPD database by artist</div>'+o,t+=isLocalHost?s+'<div id="home-composer" class="home-block'+i+'" data-path="Composer" data-browsemode="composer"><i class="fa fa-users"></i><h3>Composer</h3></div>'+o:s+'<div id="home-composer" class="home-block'+i+'" data-path="Composer" data-browsemode="composer"><i class="fa fa-users"></i><h3>Composer</h3>browse MPD database by composer</div>'+o,t+=isLocalHost?s+'<div id="home-genre" class="home-block'+i+'" data-path="Genres" data-browsemode="genre"><i class="fa fa-tags"></i><h3>Genres</h3></div>'+o:s+'<div id="home-genre" class="home-block'+i+'" data-path="Genres" data-browsemode="genre"><i class="fa fa-tags"></i><h3>Genres</h3>browse MPD database by genre</div>'+o,chkKey(e.Spotify)&&(isLocalHost?"0"===e.Spotify||("Spotify"!==e.ActivePlayer?t+=s+'<div id="home-spotify-switch" class="home-block"><i class="fa fa-spotify"></i><h3>Spotify</h3></div>'+o:t+=s+'<div id="home-spotify" class="home-block" data-plugin="Spotify" data-path="Spotify"><i class="fa fa-spotify"></i><h3>Spotify</div>'+o):"0"===e.Spotify||("Spotify"!==e.ActivePlayer?t+=s+'<div id="home-spotify-switch" class="home-block"><i class="fa fa-spotify"></i><h3>Spotify</h3>click to switch renderer</div>'+o:t+=s+'<div id="home-spotify" class="home-block" data-plugin="Spotify" data-path="Spotify"><i class="fa fa-spotify"></i><h3>Spotify</h3>music for everyone</div>'+o)),chkKey(e.Dirble)&&(t+=isLocalHost?s+'<div id="home-dirble" class="home-block'+i+'" data-plugin="Dirble" data-path="Dirble"><i class="fa fa-globe"></i><h3>Dirble</h3></div>'+o:s+'<div id="home-dirble" class="home-block'+i+'" data-plugin="Dirble" data-path="Dirble"><i class="fa fa-globe"></i><h3>Dirble</h3>radio stations open directory</div>'+o),t+=isLocalHost?s+'<div id="home-jamendo" class="home-block'+i+'" data-plugin="Jamendo" data-path="Jamendo"><i class="fa fa-play-circle-o"></i><h3>Jamendo<span id="home-count-jamendo"></span></h3></div>'+o:s+'<div id="home-jamendo" class="home-block'+i+'" data-plugin="Jamendo" data-path="Jamendo"><i class="fa fa-play-circle-o"></i><h3>Jamendo<span id="home-count-jamendo"></span></h3>world\'s largest platform for free music</div>'+o,t+="</div>",document.getElementById("home-blocks").innerHTML=t,loadingSpinner("db","hide"),$("span","#db-currentpath").html("")}function refreshState(){var e=GUI.state;if("play"===e?($("#play").addClass("btn-primary"),$("i","#play").removeClass("fa fa-pause").addClass("fa fa-play"),$("#stop").removeClass("btn-primary")):"pause"===e?($("#playlist-position span").html("Not playing"),$("#playlist-position-ss span").html("Not playing"),$("#play").addClass("btn-primary"),$("i","#play").removeClass("fa fa-play").addClass("fa fa-pause"),$("#stop").removeClass("btn-primary")):"stop"===e&&($("#play").removeClass("btn-primary"),$("i","#play").removeClass("fa fa-pause").addClass("fa fa-play"),$("#stop").addClass("btn-primary"),$("#section-index").length&&($("#countdown-display").countdown("destroy"),$("#countdown-display-ss").countdown("destroy")),"radio"===GUI.stream?($("#total").html("<span>&infin;</span>"),$("#total-ss").html("<span>&infin;</span>")):($("#total").html("00:00"),$("#total-ss").html("00:00")),$("#time").val(0,!1).trigger("update"),$("#format-bitrate").html("&nbsp;"),$("#format-bitrate-ss").html("&nbsp;"),$("li","#playlist-entries").removeClass("active")),"stop"!==e){"radio"===GUI.stream?($("#total").html("<span>&infin;</span>"),$("#total-ss").html("<span>&infin;</span>")):($("#total").html(void 0!==GUI.json.time?timeConvert(GUI.json.time):"00:00"),$("#total-ss").html(void 0!==GUI.json.time?timeConvert(GUI.json.time):"00:00"));var a=GUI.json.audio_channels&&GUI.json.audio_sample_depth&&GUI.json.audio_sample_rate?GUI.json.audio_channels+", "+GUI.json.audio_sample_depth+" bit, "+GUI.json.audio_sample_rate+" kHz, "+GUI.json.bitrate+" kbps":"&nbsp;";$("#format-bitrate").html(a),$("#format-bitrate-ss").html(a),$("li","#playlist-entries").removeClass("active");var t=parseInt(GUI.json.song);$("#playlist-entries").find("li").eq(t).addClass("active")}GUI.json.playlistlength&&"0"!==GUI.json.playlistlength?GUI.json.song?($("#playlist-position span").html("Playlist position "+(parseInt(GUI.json.song)+1)+"/"+GUI.json.playlistlength),$("#playlist-position-ss span").html("Playlist position "+(parseInt(GUI.json.song)+1)+"/"+GUI.json.playlistlength)):($("#playlist-position span").html("Playlist position 1/"+GUI.json.playlistlength),$("#playlist-position-ss span").html("Playlist position 1/"+GUI.json.playlistlength)):($("#playlist-position span").html("Empty queue, add some music!"),$("#playlist-position-ss span").html("Empty queue, add some music!")),void 0!==GUI.json.updating_db?$("a","#open-panel-sx").html('<i class="fa fa-refresh fa-spin"></i> Updating'):$("a","#open-panel-sx").html('<i class="fa fa-music sx"></i> Library')}function updateGUI(){var e=GUI.json.volume,a=GUI.json.radioname,t=GUI.json.currentartist,s=void 0===GUI.json.currentsong?"":GUI.json.currentsong,o=GUI.json.currentalbum;if(GUI.stream=null!=a&&""!==a?"radio":"",refreshState(),$("#section-index").length){if(GUI.currentsong!==GUI.json.currentsong)if(countdownRestart(0),$("#panel-dx").hasClass("active"))customScroll("pl",parseInt(GUI.json.song));0===GUI.vol_changed_local&&$("#volume").val("-1"===e?100:e,!1).trigger("update"),"radio"!==GUI.stream?($("#currentartist").html(null==t||""===t?'<span class="notag">[no artist]</span>':t),$("#currentartist-ss").html(null==t||""===t?'<span class="notag">[no artist]</span>':t),null===s||35<s.length?$("#currentsong-ss")[0].style.fontSize="26px":25<s.length?$("#currentsong-ss")[0].style.fontSize="33px":$("#currentsong-ss")[0].style.fontSize="40px",$("#currentsong").html(null==s||""===s?'<span class="notag">[no title]</span>':s),$("#currentsong-ss").html(null==s||""===s?'<span class="notag">[no title]</span>':s),null===o||45<o.length?$("#currentalbum-ss")[0].style.fontSize="20px":30<o.length?$("#currentalbum-ss")[0].style.fontSize="24px":$("#currentalbum-ss")[0].style.fontSize="30px",$("#currentalbum").html(null==o||""===o?'<span class="notag">[no album]</span>':o),$("#currentalbum-ss").html(null==o||""===o?'<span class="notag">[no album]</span>':o)):($("#currentartist").html(null==t||""===t?a:t),$("#currentartist-ss").html(null==t||""===t?a:t),$("#currentsong").html(null==s||""===s?a:s),$("#currentsong-ss").html(null==s||""===s?a:s),$("#currentalbum").html('<span class="notag">streaming</span>'),$("#currentalbum-ss").html('<span class="notag">streaming</span>')),"1"===GUI.json.repeat?$("#repeat").addClass("btn-primary"):$("#repeat").removeClass("btn-primary"),"1"===GUI.json.random?$("#random").addClass("btn-primary"):$("#random").removeClass("btn-primary"),"1"===GUI.json.consume?$("#consume").addClass("btn-primary"):$("#consume").removeClass("btn-primary"),"1"===GUI.json.single?$("#single").addClass("btn-primary"):$("#single").removeClass("btn-primary"),GUI.currentsong=s;var i=t+" - "+o;if(GUI.old_state!==GUI.state||GUI.currentalbum!==i)if(GUI.old_state=GUI.state,$("#artist-bio-ss").html(""),$("#artist-image-ss").css("background-image",""),$("#addinfo-text-ss").html(""),$("#artist-bio-overlay").html(""),$("#artist-image-overlay").css("background-image",""),$("#addinfo-text-overlay").html(""),$("#lyric-text-overlay").html(""),"radio"!==GUI.stream){var n=Math.floor(1001*Math.random());$("#cover-art").css("background-image",'url("/coverart/?v='+n+'")'),$("#cover-art-ss").css("background-image",'url("/coverart/?v='+n+'")'),$.ajax({url:"/artist_info/",success:function(e){var a=jQuery.parseJSON(e);void 0!==a.artist&&""!==a.artist.bio.content?($("#artist-bio-ss").html(a.artist.bio.content.substring(0,550)+" ... "),$("#artist-bio-overlay").html(a.artist.bio.summary),$("#artist-bio-full-overlay").html(a.artist.bio.content),$("#addinfo-text-ss").html("Similar Artists:<br>&nbsp;&nbsp;&nbsp;&nbsp;"+a.artist.similar.artist[0].name+"<br>&nbsp;&nbsp;&nbsp;&nbsp;"+a.artist.similar.artist[1].name+"<br>&nbsp;&nbsp;&nbsp;&nbsp;"+a.artist.similar.artist[2].name+"<br>&nbsp;&nbsp;&nbsp;&nbsp;"+a.artist.similar.artist[3].name+"<br>&nbsp;&nbsp;&nbsp;&nbsp;"+a.artist.similar.artist[4].name),$("#addinfo-text-overlay").html("Similar Artists:<br>&nbsp;&nbsp;&nbsp;&nbsp;"+a.artist.similar.artist[0].name+"<br>&nbsp;&nbsp;&nbsp;&nbsp;"+a.artist.similar.artist[1].name+"<br>&nbsp;&nbsp;&nbsp;&nbsp;"+a.artist.similar.artist[2].name+"<br>&nbsp;&nbsp;&nbsp;&nbsp;"+a.artist.similar.artist[3].name+"<br>&nbsp;&nbsp;&nbsp;&nbsp;"+a.artist.similar.artist[4].name+"<br>&nbsp;<br>&nbsp;"),$("#artist-image-ss").css("background-image",'url("'+a.artist.image[2]["#text"]+'")'),$("#artist-image-overlay").css("background-image",'url("'+a.artist.image[2]["#text"]+'")')):($("#artist-bio-ss").html(" sorry, no info available "),$("#artist-bio-overlay").html(" sorry, no info available "),$("#addinfo-text-ss").html(""),$("#addinfo-text-overlay").html(""),$("#lyric-text-overlay").html(""),$("#artist-image-ss").css("background-image",'url("assets/img/unkown.png")'),$("#artist-image-overlay").css("background-image",'url("assets/img/unkown.png")'))},cache:!1}),$.ajax({url:"/lyric/",success:function(e){$("#lyric-text-overlay").html(e)},cache:!1})}else{n=Math.floor(1001*Math.random());$.ajax({url:"/artist_info/",success:function(e){var a=jQuery.parseJSON(e);void 0!==a.artist&&""!==a.artist.bio.content&&($("#artist-bio-ss").html(a.artist.bio.content.substring(0,1e3)+" ... "),$("#addinfo-text-ss").html("Similar Artists:<br>&nbsp;&nbsp;&nbsp;&nbsp;"+a.artist.similar.artist[0].name+"<br>&nbsp;&nbsp;&nbsp;&nbsp;"+a.artist.similar.artist[1].name+"<br>&nbsp;&nbsp;&nbsp;&nbsp;"+a.artist.similar.artist[2].name+"<br>&nbsp;&nbsp;&nbsp;&nbsp;"+a.artist.similar.artist[3].name+"<br>&nbsp;&nbsp;&nbsp;&nbsp;"+a.artist.similar.artist[4].name),$("#artist-image-ss").css("background-image",'url("'+a.artist.image[2]["#text"]+'")'))},cache:!1}),$("#cover-art").css("background-image",'url("assets/img/cover-radio.jpg")'),$("#cover-art-ss").css("background-image",'url("assets/img/cover-radio.jpg")')}GUI.currentalbum=i}}function getPlaylistPlain(e){var a,t,s=parseInt(GUI.json.song)+1,o=GUI.json.state,i="",n="",l="",r="",d="",c="",p="",m="",u="",h="",b=0,f=0,v=0,g=e.split("\n"),y=[];for(a=0;t=g[a];a+=1)"Time"===(y=t.split(/: (.+)?/))[0]?n=parseInt(y[1]):"Artist"===y[0]?l=y[1]:"Title"===y[0]?d=y[1]:"Name"===y[0]?c=y[1]:"Album"===y[0]?r=y[1]:"file"===y[0]?p=y[1]:"Id"===y[0]&&(u=y[1],""===d||""===r?(m=parsePath(p),d=p.split("/").pop(),h=""===l?"path: "+m:l):h=l+" - "+r,""!==c?(d='<i class="fa fa-microphone"></i>'+c,h=p,b=""):(b="<span>"+timeConvert2(n)+"</span>",f+=n),v++,i+='<li id="pl-'+u+'"'+("stop"!==o&&v===s?' class="active"':"")+'><i class="fa fa-times-circle pl-action" title="Remove song from playlist"></i><span class="sn">'+d+b+'</span><span class="bl">'+h+"</span></li>",c=d=r=l=n="");$(".playlist").addClass("hide"),$("#playlist-entries").removeClass("hide");var w=document.getElementById("playlist-entries");w&&(w.innerHTML=i),$("#pl-filter-results").addClass("hide").html(""),$("#pl-filter").val(""),$("#pl-manage").removeClass("hide"),$("#pl-count").removeClass("hide").html(v+(1!==v?" entries":" entry")+" "+timeConvert3(f)+" total playtime")}function getPlaylistCmd(){loadingSpinner("pl"),$.ajax({url:"/db/?cmd=playlist",success:function(e){if(4<e.length){$(".playlist").addClass("hide"),$("#playlist-entries").removeClass("hide"),getPlaylistPlain(e);var a=parseInt(GUI.json.song);$("#panel-dx").hasClass("active")&&GUI.currentsong!==GUI.json.currentsong&&customScroll("pl",a,200)}else $(".playlist").addClass("hide"),$("#playlist-warning").removeClass("hide"),$("#pl-filter-results").addClass("hide").html(""),$("#pl-count").removeClass("hide").html("0 entries");loadingSpinner("pl","hide")},cache:!1})}function getPlaylist(e){if(data=e[0],4<data.length){$(".playlist").addClass("hide"),$("#playlist-entries").removeClass("hide"),getPlaylistPlain(data);var a=parseInt(GUI.json.song);$("#panel-dx").hasClass("active")&&GUI.currentsong!==GUI.json.currentsong&&customScroll("pl",a,200)}else $(".playlist").addClass("hide"),$("#playlist-warning").removeClass("hide"),$("#pl-filter-results").addClass("hide").html(""),$("#pl-count").removeClass("hide").html("0 entries");loadingSpinner("pl","hide")}function renderUI(e){if(toggleLoader("close"),GUI.json=e[0],GUI.state=GUI.json.state,updateGUI(),$("#section-index").length){var a=""!==GUI.json.elapsed&&void 0!==GUI.json.elapsed?GUI.json.elapsed:0,t=""!==GUI.json.time&&void 0!==GUI.json.time&&null!==GUI.json.time?GUI.json.time:0;refreshTimer(parseInt(a),parseInt(t),GUI.json.state),"radio"!==GUI.stream?refreshKnob():$("#time").val(0,!1).trigger("update"),GUI.json.playlist!==GUI.playlist&&(getPlaylistCmd(),GUI.playlist=GUI.json.playlist)}}function renderPlaylists(e){var a,t,s="",o="",i=e.split("\n"),n=[];for(a=0;t=i[a];a+=1)"playlist"===(n=t.split(": "))[0]&&(s+='<li class="pl-folder" data-path="'+(o=n[1])+'"><i class="fa fa-bars pl-action" data-target="#context-menu-playlist" data-toggle="context" title="Actions"></i><span><i class="fa fa-list-ol"></i>'+o+"</span></li>",o="");document.getElementById("playlist-entries").innerHTML="",$(".playlist").addClass("hide"),$("#pl-manage").addClass("hide"),$("#pl-count").addClass("hide"),$("#pl-filter-results").removeClass("hide").addClass("back-to-queue").html('<i class="fa fa-arrow-left sx"></i> to queue'),$("#pl-currentpath").removeClass("hide"),$("#pl-editor").removeClass("hide"),document.getElementById("pl-editor").innerHTML=s,loadingSpinner("pl","hide")}function getPlaylists(){loadingSpinner("pl"),$.ajax({url:"/command/?cmd=listplaylists",success:function(e){renderPlaylists(e)},cache:!1})}function updatePlaylistDropdown(e){var a,t,s=e.split("\n"),o=[],i="";for(a=0;t=s[a];a+=1)"playlist"===(o=t.split(": "))[0]&&(i+='<option value="'+o[1]+'" />');document.getElementById("pl-list").innerHTML=i,loadingSpinner("pl","hide")}function getPlaylistsDropdown(){loadingSpinner("pl"),$.ajax({url:"/command/?cmd=listplaylists",success:function(e){updatePlaylistDropdown(e)},cache:!1})}function parseResponse(e){var a=e.inputArr||"",t=e.respType||"",s=e.i||0,o=e.inpath||"",i=e.querytype||"",n="";switch(t){case"playlist":break;case"db":"file"===GUI.browsemode?(""===o&&void 0!==a.file&&(o=parsePath(a.file)),void 0!==a.file||"Webradio"===o?(n='<li id="db-'+(s+1)+'" data-path="',void 0!==a.Title?(n+=a.file,n+='"><i class="fa fa-bars db-action" title="Actions" data-toggle="context" data-target="#context-menu-file"></i><i class="fa fa-music db-icon"></i><span class="sn">',n+=a.Title+" <span>"+timeConvert(a.Time)+"</span></span>",n+=' <span class="bl">',n+=a.Artist,n+=" - ",n+=a.Album):"Webradio"!==o?(n+=a.file,n+='"><i class="fa fa-bars db-action" title="Actions" data-toggle="context" data-target="#context-menu-file"></i><i class="fa fa-music db-icon"></i><span class="sn">',n+=a.file.replace(o+"/","")+" <span>"+timeConvert(a.Time)+"</span></span>",n+='<span class="bl">',n+=" path: ",n+=o):(n+=a.playlist,n+='"><i class="fa fa-bars db-action" title="Actions" data-toggle="context" data-target="#context-menu-webradio"></i><i class="fa fa-microphone db-icon db-radio"></i>',n+='<span class="sn">'+a.playlist.replace(o+"/","").replace("."+a.fileext,""),n+='</span><span class="bl">webradio'),n+="</span></li>"):void 0!==a.playlist?"cue"===a.fileext&&(n='<li id="db-'+(s+1)+'" data-path="',n+=a.playlist,n+='"><i class="fa fa-bars db-action" title="Actions" data-toggle="context" data-target="#context-menu-file"></i><i class="fa fa-file-text db-icon"></i><span class="sn">',n+=a.playlist.replace(o+"/","")+" <span>[CUE file]</span></span>",n+='<span class="bl">',n+=" path: ",n+=o,n+="</span></li>"):(n='<li id="db-'+(s+1)+'" class="db-folder" data-path="',n+=a.directory,n+=""!==o?'"><i class="fa fa-bars db-action" title="Actions" data-toggle="context" data-target="#context-menu"></i><span><i class="fa fa-folder-open"></i>':'"><i class="fa fa-bars db-action" title="Actions" data-toggle="context" data-target="#context-menu-root"></i><i class="fa fa-hdd-o icon-root"></i><span>',n+=a.directory.replace(o+"/",""),n+="</span></li>")):"album"===GUI.browsemode||"albumfilter"===GUI.browsemode?void 0!==a.file?(n='<li id="db-'+(s+1)+'" data-path="',n+=a.file,n+='"><i class="fa fa-bars db-action" title="Actions" data-toggle="context" data-target="#context-menu-file"></i><i class="fa fa-music db-icon"></i><span class="sn">',n+=a.Title+" <span>"+timeConvert(a.Time)+"</span></span>",n+=' <span class="bl">',n+=a.Artist,n+=" - ",n+=a.Album,n+="</span></li>"):""!==a.album&&(n='<li id="db-'+(s+1)+'" class="db-folder db-album" data-path="',n+=a.album.replace(/\"/g,"&quot;"),n+='"><i class="fa fa-bars db-action" title="Actions" data-toggle="context" data-target="#context-menu-album"></i><span><i class="fa fa-dot-circle-o"></i>',n+=a.album,n+="</span></li>"):"artist"===GUI.browsemode?void 0!==a.album?(n='<li id="db-'+(s+1)+'" class="db-folder db-album" data-path="',n+=a.album,n+='"><i class="fa fa-bars db-action" title="Actions" data-toggle="context" data-target="#context-menu-album"></i><span><i class="fa fa-dot-circle-o"></i>',n+=""!==a.album?a.album:"Unknown album",n+="</span></li>"):""!==a.artist&&(n='<li id="db-'+(s+1)+'" class="db-folder db-artist" data-path="',n+=a.artist,n+='"><i class="fa fa-bars db-action" title="Actions" data-toggle="context" data-target="#context-menu-artist"></i><span><i class="fa fa-user"></i>',n+=a.artist,n+="</span></li>"):"composer"===GUI.browsemode?void 0!==a.file?(n='<li id="db-'+(s+1)+'" data-path="',n+=a.file,n+='"><i class="fa fa-bars db-action" title="Actions" data-toggle="context" data-target="#context-menu-file"></i><i class="fa fa-music db-icon"></i><span class="sn">',n+=a.Title+" <span>"+timeConvert(a.Time)+"</span></span>",n+=' <span class="bl">',n+=a.Artist,n+=" - ",n+=a.Album,n+="</span></li>"):""!==a.composer&&(n='<li id="db-'+(s+1)+'" class="db-folder db-composer" data-path="',n+=a.composer,n+='"><i class="fa fa-bars db-action" title="Actions" data-toggle="context" data-target="#context-menu-composer"></i><span><i class="fa fa-user"></i>',n+=a.composer,n+="</span></li>"):"genre"===GUI.browsemode&&(void 0!==a.artist?(n='<li id="db-'+(s+1)+'" class="db-folder db-artist" data-path="',n+=a.artist,n+='"><i class="fa fa-bars db-action" title="Actions" data-toggle="context" data-target="#context-menu-artist"></i><span><i class="fa fa-dot-circle-o"></i>',n+=""!==a.artist?a.artist:"Unknown artist",n+="</span></li>"):""!==a.genre&&(n='<li id="db-'+(s+1)+'" class="db-folder db-genre" data-path="',n+=a.genre,n+='"><i class="fa fa-bars db-action" title="Actions" data-toggle="context" data-target="#context-menu-genre"></i><span><i class="fa fa-tags"></i>',n+=a.genre,n+="</span></li>"));break;case"Spotify":""===i?(n='<li id="db-'+(s+1)+'" class="db-spotify db-folder" data-path="',n+=a.index,n+='"><i class="fa fa-bars db-action" title="Actions" data-toggle="context" data-target="#context-menu-spotify-pl"></i><span><i class="fa fa-folder-open"></i>',n+=""!==a.name?a.name:"Favorites",n+=" (",n+=a.tracks,n+=")</span></li>"):"tracks"===i&&(n='<li id="db-'+(s+1)+'" class="db-spotify" data-path="',n+=a.index,n+='" data-plid="',n+=o,n+='" data-type="spotify-track"><i class="fa fa-bars db-action" title="Actions" data-toggle="context" data-target="#context-menu-spotify"></i><i class="fa fa-spotify db-icon"></i><span class="sn">',n+=a.title+" <span>"+timeConvert(a.duration/1e3)+"</span></span>",n+=' <span class="bl">',n+=a.artist,n+=" - ",n+=a.album,n+="</span></li>");break;case"Dirble":if(""===i||"childs"===i)n='<li id="db-'+(s+1)+'" class="db-dirble db-folder'+("childs"===i?" db-dirble-child":"")+'" data-path="',n+=a.id,n+='"><span><i class="fa fa-folder-open"></i>',n+=a.title,n+="</span></li>";else if("search"===i||"stations"===i||"childs-stations"===i){if(0===a.streams.length)break;n='<li id="db-'+(s+1)+'" class="db-dirble db-radio" data-path="',n+=a.name+" | "+a.streams[0].stream,n+='"><i class="fa fa-bars db-action" title="Actions" data-toggle="context" data-target="#context-menu-dirble"></i><i class="fa fa-microphone db-icon"></i>',n+='<span class="sn">'+a.name+"<span>("+a.country+")</span></span>",n+='<span class="bl">',n+=a.website?a.website:"-no website-",n+="</span></li>"}break;case"Jamendo":n='<li id="db-'+(s+1)+'" class="db-jamendo db-folder" data-path="',n+=a.stream,n+='"><img class="jamendo-cover" src="/tun/'+a.image+'" alt=""><i class="fa fa-bars db-action" title="Actions" data-toggle="context" data-target="#context-menu-file"></i>',n+=a.dispname+"</div></li>"}return n}function populateDB(e){var a=e.data||"",t=e.path||"",s=e.uplevel||0,o=e.keyword||"",i=e.plugin||"",n=e.querytype||"",l=e.args||"",r="",d=0,c=[];if(console.log(JSON.stringify(a)),""!==i){if("Spotify"===i){for($("#database-entries").removeClass("hide"),$("#db-level-up").removeClass("hide"),$("#home-blocks").addClass("hide"),t&&(GUI.currentpath=t),document.getElementById("database-entries").innerHTML="",(a="tracks"===n?a.tracks:a.playlists).sort(function(e,a){if("Spotify"===t&&""===n)nameA=e.hasOwnProperty("name")?e.name.toLowerCase():"",nameB=a.hasOwnProperty("name")?a.name.toLowerCase():"";else{if("tracks"!==n)return 0;nameA=e.hasOwnProperty("title")?e.title.toLowerCase():"",nameB=a.hasOwnProperty("title")?a.title.toLowerCase():""}return nameA.localeCompare(nameB)}),d=0;c=a[d];d+=1)r+=parseResponse({inputArr:c,respType:"Spotify",i:d,querytype:n,inpath:l});document.getElementById("database-entries").innerHTML=r}if("Dirble"===i){for($("#database-entries").removeClass("hide"),$("#db-level-up").removeClass("hide"),$("#home-blocks").addClass("hide"),t&&(GUI.currentpath="search"===n?"Dirble":t),"childs-stations"===n?r=document.getElementById("database-entries").innerHTML:document.getElementById("database-entries").innerHTML="",a.sort(function(e,a){if(""===n||"childs"===n||"categories"===n)nameA=e.hasOwnProperty("title")?e.title.toLowerCase():"",nameB=a.hasOwnProperty("title")?a.title.toLowerCase():"";else{if("childs-stations"!==n&&"stations"!==n)return 0;nameA=e.hasOwnProperty("name")?e.name.toLowerCase():"",nameB=a.hasOwnProperty("name")?a.name.toLowerCase():""}return nameA.localeCompare(nameB)}),d=0;c=a[d];d+=1)r+=parseResponse({inputArr:c,respType:"Dirble",i:d,querytype:n});document.getElementById("database-entries").innerHTML=r}if("Jamendo"===i){for($("#database-entries").removeClass("hide"),$("#db-level-up").removeClass("hide"),$("#home-blocks").addClass("hide"),t&&(GUI.currentpath=t),document.getElementById("database-entries").innerHTML="",a.sort(function(e,a){return"Jamendo"!==t||""!==n?0:(nameA=e.hasOwnProperty("dispname")?e.dispname.toLowerCase():"",nameB=a.hasOwnProperty("dispname")?a.dispname.toLowerCase():"",nameA.localeCompare(nameB))}),d=0;c=a[d];d+=1)r+=parseResponse({inputArr:c,respType:"Jamendo",i:d,querytype:n});document.getElementById("database-entries").innerHTML=r}}else{if(""===t&&""===o)return void renderLibraryHome();if($("#database-entries").removeClass("hide"),$("#db-level-up").removeClass("hide"),$("#home-blocks").addClass("hide"),t&&(GUI.currentpath=t),(document.getElementById("database-entries").innerHTML="")!==o){var p=a.length?a.length:"0",m=1===a.length?"":"s";$("#db-level-up").addClass("hide"),$("#db-search-results").removeClass("hide").html('<i class="fa fa-times sx"></i><span class="visible-xs-inline">back</span><span class="hidden-xs">'+p+" result"+m+' for "<span class="keyword">'+o+'</span>"</span>')}for(a.sort(function(e,a){if("Artists"===t||"AlbumArtists"===t||"Various Artists"===t)nameA=e.hasOwnProperty("artist")?e.artist.toLowerCase():"",nameB=a.hasOwnProperty("artist")?a.artist.toLowerCase():"";else if("Albums"===t)nameA=e.hasOwnProperty("album")?e.album.toLowerCase():"",nameB=a.hasOwnProperty("album")?a.album.toLowerCase():"";else if("Webradio"===t)nameA=e.hasOwnProperty("playlist")?e.playlist.toLowerCase():"",nameB=a.hasOwnProperty("playlist")?a.playlist.toLowerCase():"";else if("Genres"===t)nameA=e.hasOwnProperty("genre")?e.genre.toLowerCase():"",nameB=a.hasOwnProperty("genre")?a.genre.toLowerCase():"";else{if(!t)return 0;nameA=e.hasOwnProperty("directory")?e.directory.toLowerCase():"",nameB=a.hasOwnProperty("directory")?a.directory.toLowerCase():""}return nameA.localeCompare(nameB)}),"Webradio"===t&&(r+='<li id="webradio-add" class="db-webradio-add"><i class="fa fa-plus-circle db-icon"></i><span class="sn"><em>add new</em></span><span class="bl">add a webradio to your library</span></li>'),d=0;c=a[d];d+=1)r+=parseResponse({inputArr:c,respType:"db",i:d,inpath:t});document.getElementById("database-entries").innerHTML=r}var u=$("span","#db-currentpath");if("album"===GUI.browsemode?"Albums"===t?u.html(t):u.html("Albums/"+t):"artist"===GUI.browsemode?"Artists"===t?u.html(t):u.html("Artists/"+t):"composer"===GUI.browsemode?"Composer"===t?u.html(t):u.html("Composer/"+t):"genre"===GUI.browsemode?"Genres"===t?u.html(t):u.html("Genres/"+t):u.html(t),$("#db-homeSetup").addClass("hide"),s){var h=GUI.currentDBpos[GUI.currentDBpos[10]];$("#db-"+h).addClass("active"),customScroll("db",h,0)}else customScroll("db",0,0);"childs"!=n&&loadingSpinner("db","hide")}function getDB(e){var a=e.cmd||"browse",t=e.path||"",s=e.browsemode||"file",o=e.uplevel||"",i=e.plugin||"",n=e.querytype||"",l=e.args||"";if(loadingSpinner("db"),GUI.browsemode=s,""!==i)"Spotify"===i?$.post("/db/?cmd=spotify",{plid:l},function(e){populateDB({data:e,path:t,plugin:i,querytype:n,uplevel:o,args:l})},"json"):"Dirble"===i?"childs"===n?($.post("/db/?cmd=dirble",{querytype:"childs",args:l},function(e){populateDB({data:e,path:t,plugin:i,querytype:"childs",uplevel:o})},"json"),$.post("/db/?cmd=dirble",{querytype:"childs-stations",args:l},function(e){populateDB({data:e,path:t,plugin:i,querytype:"childs-stations",uplevel:o})},"json")):$.post("/db/?cmd=dirble",{querytype:""===n?"categories":n,args:l},function(e){populateDB({data:e,path:t,plugin:i,querytype:n,uplevel:o})},"json"):"Jamendo"===i&&$.post("/db/?cmd=jamendo",{querytype:""===n?"radio":n,args:l},function(e){populateDB({data:e.results,path:t,plugin:i,querytype:n})},"json");else if("search"===a){var r=$("#db-search-keyword").val();t.match(/Dirble/)?$.post("/db/?cmd=dirble",{querytype:"search",args:r},function(e){populateDB({data:e,path:t,plugin:"Dirble",querytype:"search",uplevel:o})},"json"):$.post("/db/?querytype="+GUI.browsemode+"&cmd=search",{query:r},function(e){populateDB({data:e,path:t,uplevel:o,keyword:r})},"json")}else"browse"===a?$.post("/db/?cmd=browse",{path:t,browsemode:GUI.browsemode},function(e){populateDB({data:e,path:t,uplevel:o})},"json"):(loadingSpinner("db","hide"),$.post("/db/?cmd="+a,{path:t,querytype:n},function(e){},"json"))}function onreleaseKnob(e){if("stop"!==GUI.state&&""!==GUI.state)if("radio"!==GUI.stream){window.clearInterval(GUI.currentKnob);var a=Math.floor(e*parseInt(GUI.json.time)/1e3);sendCmd("seek "+GUI.json.song+" "+a),$("#time").val(e),$("#countdown-display").countdown("destroy"),$("#countdown-display-ss").countdown("destroy"),$("#countdown-display").countdown({since:-a,compact:!0,format:"MS"}),$("#countdown-display-ss").countdown({since:-a,compact:!0,format:"MS"})}else $("#time").val(0).trigger("change")}function commandButton(e){var a,t=e.data("cmd");if("stop"===t)e.addClass("btn-primary"),$("#play").removeClass("btn-primary"),$("#section-index").length&&(refreshTimer(0,0,"stop"),window.clearInterval(GUI.currentKnob),$(".playlist").find("li").removeClass("active"),$("#total").html("00:00"),$("#total-ss").html("00:00"));else{if("play"===t){var s=GUI.state;return"play"===s?(a="pause",$("#section-index").length&&($("#countdown-display").countdown("pause"),$("#countdown-display-ss").countdown("pause"))):"pause"===s?(a="play",$("#section-index").length&&($("#countdown-display").countdown("resume"),$("#countdown-display-ss").countdown("resume"))):"stop"===s&&(a="play",$("#section-index").length&&($("#countdown-display").countdown({since:0,compact:!0,format:"MS"}),$("#countdown-display-ss").countdown({since:0,compact:!0,format:"MS"}))),window.clearInterval(GUI.currentKnob),void sendCmd(a)}if("previous"===t||"next"===t)$("#section-index").length&&($("#countdown-display").countdown("pause"),$("#countdown-display-ss").countdown("pause"),window.clearInterval(GUI.currentKnob));else if(e.hasClass("btn-volume")){var o,i=parseInt($("#volume").val());return"volumedn"===t&&0<parseInt(GUI.volume)?(o=parseInt(GUI.volume)-1,GUI.volume=o,$("#volumemute").removeClass("btn-primary")):"volumeup"===t&&parseInt(GUI.volume)<100?(o=parseInt(GUI.volume)+1,GUI.volume=o,$("#volumemute").removeClass("btn-primary")):"volumemute"===t&&(0!==i?(GUI.volume=i,e.addClass("btn-primary"),o=0):(e.removeClass("btn-primary"),o=GUI.volume)),void(0<=o&&o<=100&&(sendCmd("setvol "+o),$("#volume").val(o,!1).trigger("update")))}}e.hasClass("btn-toggle")?(a=t+(e.hasClass("btn-primary")?" 0":" 1"),e.toggleClass("btn-primary")):a=t,sendCmd(a)}function libraryHome(e){GUI.libraryhome=e[0],GUI.libraryhome.clientUUID===GUI.clientUUID&&"Dirble"!==GUI.plugin&&"Webradio"!==GUI.currentpath&&renderLibraryHome(),"Webradio"===GUI.currentpath&&getDB({path:"Webradio",uplevel:0}),!0===GUI.forceGUIupdate&&(GUI.forceGUIupdate=!1,renderLibraryHome())}function listWLANs(e){var a="",t="",s="",o=e[0];$.each(o,function(e){a+='<p><a href="/network/wlan/'+o[e].nic+"/"+o[e].ESSID+'" class="btn btn-lg btn-default btn-block" title="See network properties">',0!==o[e].connected&&(a+='<i class="fa fa-check green sx"></i>'),1===o[e].storedprofile&&"on"===o[e].encryption?a+='<i class="fa fa-lock sx"></i>':"on"===o[e].encryption?a+='<i class="fa fa-rss fa-wifi"></i><i class="fa fa-lock sx"></i>':1!==o[e].storedprofile&&(a+='<i class="fa fa-rss fa-wifi sx"></i>'),a+="<strong>"+o[e].ESSID+"</strong></a></p>","scan"===o[e].origin&&(t+=a),1===o[e].storedprofile&&(s+=a),a=""}),""===t&&(t='<p><a class="btn btn-lg btn-default btn-block" href="#"><i class="fa fa-cog fa-spin sx"></i>scanning for networks...</a></p>'),document.getElementById("wifiNetworks").innerHTML=t,document.getElementById("wifiStored").innerHTML=s,$.ajax({url:"/command/?cmd=wifiscan",cache:!1})}function nicsDetails(e){var a="",t=e[0];$.each(t,function(e){e===$("#nic-details").data("name")&&(a+="<tr><th>Name:</th><td><strong>"+e+"<strong></td></tr>",a+="<tr><th>Type:</th><td>wireless</td></tr>",null===t[e].currentssid?a+='<tr><th>Status:</th><td><i class="fa fa-times red sx"></i>no network connected</td></tr>':(a+='<tr><th>Status:</th><td><i class="fa fa-check green sx"></i>connected</td></tr>',a+="<tr><th>Associated SSID:</th><td><strong>"+t[e].currentssid+"</strong></td></tr>"),a+="<tr><th>Assigned IP:</th><td>"+(null!==t[e].ip?"<strong>"+t[e].ip+"</strong>":"none")+"</td></tr>",a+="<tr><th>Speed:</th><td>"+(null!==t[e].speed?t[e].speed:"unknown")+"</td></tr>",null!==t[e].currentssid&&(a+="<tr><th>Netmask:</th><td>"+t[e].netmask+"</td></tr>",a+="<tr><th>Gateway:</th><td>"+t[e].gw+"</td></tr>",a+="<tr><th>DNS1:</th><td>"+t[e].dns1+"</td></tr>",a+="<tr><th>DNS2:</th><td>"+t[e].dns2+"</td></tr>"))}),$("#nic-details tbody").html(a)}function playbackChannel(){var e=new PushStream({host:window.location.hostname,port:window.location.port,modes:GUI.mode,reconnectOnChannelUnavailableInterval:5e3});e.onmessage=renderUI,e.onstatuschange=function(e){2===e?($("#loader").addClass("hide"),sendCmd("renderui")):0===e&&toggleLoader()},e.addChannel("playback"),e.connect()}function queueChannel(){var e=new PushStream({host:window.location.hostname,port:window.location.port,modes:GUI.mode});e.onmessage=getPlaylist,e.addChannel("queue"),e.connect()}function libraryChannel(){var e=new PushStream({host:window.location.hostname,port:window.location.port,modes:GUI.mode});e.onmessage=libraryHome,e.addChannel("library"),e.connect()}function notifyChannel(){var e=new PushStream({host:window.location.hostname,port:window.location.port,modes:GUI.mode});e.onmessage=renderMSG,e.addChannel("notify"),e.connect()}function wlansChannel(){var e=new PushStream({host:window.location.hostname,port:window.location.port,modes:GUI.mode});e.onmessage=listWLANs,e.addChannel("wlans"),e.connect(),$.ajax({url:"/command/?cmd=wifiscan",cache:!1})}function nicsChannel(){var e=new PushStream({host:window.location.hostname,port:window.location.port,modes:GUI.mode});e.onmessage=nicsDetails,e.addChannel("nics"),e.connect()}function overlayTrigger(a){var t=$(a),e=$(a+"-open"),s=$(a+"-close");function o(){if(t.hasClass("open")){t.removeClass("open"),t.addClass("closed")}else if(t.hasClass("closed")&&(t.addClass("open"),"#overlay-social"===a)){var e="https://twitter.com/home?status=Listening+to+"+GUI.json.currentsong.replace(/\s+/g,"+")+"+by+"+GUI.json.currentartist.replace(/\s+/g,"+")+"+on+%40RuneAudio+http%3A%2F%2Fwww.runeaudio.com%2F+%23nowplaying";$("#urlTwitter").attr("href",e),$("#urlFacebook").attr("href","https://www.facebook.com/sharer.php?u=http%3A%2F%2Fwww.runeaudio.com%2F&display=popup"),$("#urlGooglePlus").attr("href","https://plus.google.com/share?url=http%3A%2F%2Fwww.runeaudio.com%2F")}}transEndEventNames={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"},e.click(function(){o()}),s.click(function(){o()})}function getHiddenProp(){var e=["webkit","moz","ms","o"];if("hidden"in document)return"hidden";for(var a=0;a<e.length;a++)if(e[a]+"Hidden"in document)return e[a]+"Hidden";return null}function isHidden(){var e=getHiddenProp();return!!e&&document[e]}function visChange(){isHidden()?GUI.visibility="hidden":GUI.visibility="visible"}$(document).ready(function(){if(GUI.clientUUID=generateUUID(),$("#section-index").length){if("localhost"===location.hostname||"127.0.0.1"===location.hostname?(isLocalHost=1,SStime=localSStime):(isLocalHost=0,SStime=remoteSStime),0<=SStime)setInterval(timerIncrement,1e3);$(this).on("mousemove click keypress",function(e){idleTime=0,viewScreenSaver&&($(".tab-content").show("slow"),$(".screen-saver-content").hide("slow"),$("#menu-bottom").show("slow"),$("#menu-top").show("slow"),viewScreenSaver=0)})}}),$("#section-index").length?jQuery(document).ready(function(o){"use strict";GUI.mode=checkWebSocket(),playbackChannel(),libraryChannel(),PNotify.prototype.options.styling="fontawesome",PNotify.prototype.options.stack.dir1="up",PNotify.prototype.options.stack.dir2="left",PNotify.prototype.options.stack.firstpos1=90,PNotify.prototype.options.stack.firstpos2=50,PNotify.prototype.options.stack.spacing1=10,PNotify.prototype.options.stack.spacing2=10,notifyChannel();var a,t,e=getHiddenProp();if(e){var s=e.replace(/[H|h]idden/,"")+"visibilitychange";document.addEventListener(s,visChange)}function i(){var e;clearInterval(a),(t-=10)<50&&(t=50),a=setInterval(i,t);parseInt(o("#volume").val());0<parseInt(GUI.volume)&&(e=parseInt(GUI.volume)-1,GUI.volume=e,o("#volumemute").removeClass("btn-primary")),0<=e&&e<=100&&(setvol(e),o("#volume").val(e,!1).trigger("update"))}function n(){var e;clearInterval(a),(t-=10)<50&&(t=50),a=setInterval(n,t);parseInt(o("#volume").val());parseInt(GUI.volume)<100&&(e=parseInt(GUI.volume)+1,GUI.volume=e,o("#volumemute").removeClass("btn-primary")),0<=e&&e<=100&&(setvol(e),o("#volume").val(e,!1).trigger("update"))}o(".btn-cmd").click(function(){commandButton(o(this))}),o("#volumedn").on("mouseleave mouseout mouseup",function(){return clearInterval(a),!1}),o("#volumedn").mousedown(function(){return t=300,a=setInterval(i,t+200),!1}),o("#volumeup").on("mouseleave mouseout mouseup",function(){return clearInterval(a),!1}),o("#volumeup").mousedown(function(){return t=300,a=setInterval(n,t+200),!1}),o("#countdown-display").click(function(){sendCmd("pause")}),o("#total").click(function(){sendCmd("pause")}),o("#random").click(function(){"pl-ashuffle-stop"===o("#random").attr("data-cmd")&&(o.post("/db/?cmd=pl-ashuffle-stop",""),o("#random").attr("data-cmd","random"),o("#random").attr("title","Random"),o("#random").removeClass("btn-primary"))}),o("#time").knob({inline:!1,change:function(e){"stop"!==GUI.state?window.clearInterval(GUI.currentKnob):o("#time").val(0).trigger("change")},release:function(e){onreleaseKnob(e)}});var l=o("#volume").data("dynamic");o("#volume").knob({inline:!1,change:function(e){var a=parseInt(e);return a>GUI.maxvol-4&&GUI.checkvol<GUI.minvol+5?(o("#volume").val(0),l&&o(document).mouseup(),!1):a<GUI.minvol+4&&GUI.checkvol>GUI.maxvol-5?(o("#volume").val(100),l&&o(document).mouseup(),!1):(l&&a!==GUI.volume&&setvol(a),void(GUI.checkvol=a))},release:function(e){var a=parseInt(e);l||a===GUI.volume||setvol(a)},draw:function(){if("tron"===this.$.data("skin")){this.cursorExt=.05;var e,a=this.arc(this.cv);return this.g.lineWidth=this.lineWidth,this.o.displayPrevious&&(e=this.arc(this.v),this.g.beginPath(),this.g.strokeStyle=this.pColor,this.g.arc(this.xy,this.xy,this.radius-this.lineWidth,e.s,e.e,e.d),this.g.stroke()),this.g.beginPath(),this.g.strokeStyle=this.o.fgColor,this.g.arc(this.xy,this.xy,this.radius-this.lineWidth,a.s,a.e,a.d),this.g.stroke(),this.g.lineWidth=2,this.g.beginPath(),this.g.strokeStyle=this.o.fgColor,this.g.arc(this.xy,this.xy,this.radius-this.lineWidth+13+this.lineWidth,0,2*Math.PI,!1),this.g.stroke(),!1}}}),o("#playlist-entries").on("click","li",function(e){if(o(e.target).hasClass("pl-action")){e.preventDefault();var a=o(this).attr("id");sendCmd("deleteid "+(a=parseInt(a.replace("pl-",""))))}else{sendCmd("play "+o("li","#playlist-entries").index(this)),o("li.active","#playlist-entries").removeClass("active"),o(this).addClass("active")}}),o("a","#open-panel-dx").click(function(){o("#open-panel-dx").hasClass("active")&&(customScroll("pl",parseInt(GUI.json.song),500),o("#pl-filter-results").hasClass("hide")||o("#pl-filter-results").click())}).on("shown.bs.tab",function(e){customScroll("pl",parseInt(GUI.json.song),0)}),o("#open-library").click(function(){o("#open-panel-dx").removeClass("active"),o("#open-panel-sx").addClass("active")}),o("#pl-filter").keyup(function(){o.scrollTo(0,500);var a=o(this).val(),t=0;o("li","#playlist-entries").each(function(){var e=o(this);e.text().search(new RegExp(a,"i"))<0?e.hide():(e.show(),t++)});var e=1===t?"":"s";""!==a?(o("#pl-count").addClass("hide"),o("#pl-filter-results").removeClass("hide").html('<i class="fa fa-times sx"></i><span class="visible-xs-inline">back</span><span class="hidden-xs">'+ +t+" result"+e+' for "<span class="keyword">'+a+'</span>"</span>')):(o("#pl-count").removeClass("hide"),o("#pl-filter-results").addClass("hide").html(""))}),o("#pl-filter-results").click(function(){o(this).addClass("hide"),o("#pl-count").removeClass("hide"),o(this).hasClass("back-to-queue")?(o(".playlist").addClass("hide"),getPlaylistCmd(),o("#pl-currentpath").addClass("hide"),o("#pl-manage").removeClass("hide")):(o("li","#playlist-entries").each(function(){o(this).show()}),o("#pl-currentpath").removeClass("hide"),o("#pl-filter").val("")),customScroll("pl",parseInt(GUI.json.song),500)}),o("#pl-manage-list").click(function(){getPlaylists()}),o("#modal-pl-save-btn").click(function(){sendCmd('save "'+o("#pl-save-name").val()+'"')}),o("#pl-editor").on("click",".pl-action",function(e){e.preventDefault();var a=o(this).parent().attr("data-path");GUI.DBentry[0]=a}),o("#pl-rename-button").click(function(){sendCmd('rename "'+o("#pl-rename-oldname").text()+'" "'+o("#pl-rename-name").val()+'"'),getPlaylists()}),o("#pl-manage-save").click(function(){getPlaylistsDropdown()});var r=document.getElementById("playlist-entries");new Sortable(r,{ghostClass:"sortable-ghost",onUpdate:function(e){sortOrder(e.item.getAttribute("id"))}}),o("a","#open-panel-sx").click(function(){o("#open-panel-sx").hasClass("active")&&customScroll("pl",parseInt(GUI.json.song),500)}).on("shown.bs.tab",function(e){customScroll("db",GUI.currentDBpos[GUI.currentDBpos[10]],0)}),o("#home-blocks").on("click",".home-block",function(e){if(o(this).hasClass("inactive"))o("#overlay-playsource-open").trigger("click");else if(o(this).is("#home-spotify-switch"))o("#overlay-playsource-open").trigger("click");else if(o(e.target).is("span.block-remove")){var a=o(this).attr("id");a=a.replace("home-bookmark-","");var t=o(this).find("h3").text();o.post("/db/?cmd=bookmark",{id:a,name:t})}else++GUI.currentDBpos[10],getDB({browsemode:o(this).data("browsemode"),path:o(this).data("path"),uplevel:0,plugin:o(this).data("plugin")})}),o("#db-homeSetup").click(function(){var e=o(this);e.hasClass("btn-primary")?(e.removeClass("btn-primary").addClass("btn-default"),o(".home-block-remove").remove()):(e.removeClass("btn-default").addClass("btn-primary"),o(".home-block.home-bookmark").append('<div class="home-block-remove" title="Remove this bookmark"><span class="block-remove">&times;</span></div>'))});var d=o("#database-entries");d.on("click","li",function(e){var a="",t=o(this);if(o(e.target).hasClass("db-action"))e.preventDefault(),a="spotify-track"===t.data("type")?t.data("plid")+"-"+t.data("path"):t.data("path"),GUI.DBentry[0]=a;else if(o("li.active","#database-entries").removeClass("active"),t.addClass("active"),t.hasClass("db-folder")){if(a=t.data("path"),t.hasClass("db-album"))getDB(""!==a?{path:a,uplevel:0,browsemode:"album"}:{path:a=GUI.currentDBpath[GUI.currentDBpos[10]-1],uplevel:0,browsemode:"albumfilter"});else if(t.hasClass("db-artist"))getDB({path:a,uplevel:0,browsemode:"artist"});else if(t.hasClass("db-composer"))getDB({path:a,uplevel:0,browsemode:"composer"});else if(t.hasClass("db-genre"))getDB({path:a,uplevel:0,browsemode:"genre"});else if(t.hasClass("db-spotify"))getDB({path:a=GUI.currentpath+"/"+t.find("span").text(),plugin:"Spotify",args:t.data("path").toString(),querytype:"tracks"}),GUI.plugin="Spotify";else if(t.hasClass("db-dirble")){getDB({path:a=GUI.currentpath+"/"+t.find("span").text(),plugin:"Dirble",querytype:t.hasClass("db-dirble-child")?"stations":"childs",args:t.data("path")}),GUI.plugin="Dirble"}else t.hasClass("db-jamendo")||getDB({path:a,uplevel:0,browsemode:t.data("browsemode")});var s=t.attr("id");s=s.replace("db-",""),GUI.currentDBpos[GUI.currentDBpos[10]]=s,GUI.currentDBpath[GUI.currentDBpos[10]]=a,++GUI.currentDBpos[10]}else t.hasClass("db-webradio-add")&&o("#modal-webradio-add").modal()}),d.on("dblclick","li",function(e){var a=o(this);if(!o(e.target).hasClass("db-action")){o("li.active","#database-entries").removeClass("active"),a.addClass("active");var t=a.data("path");a.hasClass("db-spotify")?getDB({cmd:"spaddplay",path:t=a.attr("data-plid")+"-"+a.attr("data-path"),querytype:"spotify-track"}):getDB({cmd:"addplay",path:t=a.hasClass("db-dirble")?t.split(" | ")[1]:t})}}),o("#db-level-up").click(function(){--GUI.currentDBpos[10];var e=GUI.currentpath;if(0===GUI.currentDBpos[10])e="";else if("file"===GUI.browsemode){var a=e.lastIndexOf("/");e=-1!==a?e.slice(0,a):""}else"album"===GUI.browsemode?""===(e=GUI.currentDBpath[GUI.currentDBpos[10]-1])?e="Albums":GUI.browsemode="artist":"artist"===GUI.browsemode?""===(e=GUI.currentDBpath[GUI.currentDBpos[10]-1])?e="Artists":GUI.browsemode="genre":"composer"===GUI.browsemode?""===(e=GUI.currentDBpath[GUI.currentDBpos[10]-1])?e="Composer":GUI.browsemode="artist":"genre"===GUI.browsemode?e="Genres":"albumfilter"===GUI.browsemode&&(GUI.browsemode="artist",e=GUI.currentDBpath[GUI.currentDBpos[10]-1]);getDB({browsemode:GUI.browsemode,path:e,plugin:GUI.plugin,uplevel:1}),GUI.plugin=""}),o("#db-search-results").click(function(){o(this).addClass("hide"),o("#db-level-up").removeClass("hide"),getDB({path:GUI.currentpath})}),o("a",".context-menu").click(function(){var e=o(this).data("cmd"),a=o(this).data("type"),t=GUI.DBentry[0];switch(GUI.DBentry[0]="",e){case"pl-add":sendCmd('load "'+t+'"');break;case"pl-replace":sendCmd("clear"),sendCmd('load "'+t+'"');break;case"pl-addreplaceplay":sendCmd("clear"),sendCmd('load "'+t+'"'),sendCmd("play");break;case"pl-rename":o("#modal-pl-rename").modal(),o("#pl-rename-oldname").text(t);break;case"pl-rm":o.ajax({url:"/command/?cmd=rm%20%22"+t+"%22",success:function(e){getPlaylists(e)},cache:!1});break;case"pl-ashuffle":o.post("/db/?cmd=pl-ashuffle",{playlist:t}),o("#random").attr("data-cmd","pl-ashuffle-stop"),o("#random").attr("title","Stop randomly adding songs"),o("#random").addClass("btn-primary");break;case"wradd":getDB({cmd:"add",path:t=t.split(" | ")[1]});break;case"wraddplay":getDB({cmd:"addplay",path:t=t.split(" | ")[1]});break;case"wraddreplaceplay":getDB({cmd:"addreplaceplay",path:t=t.split(" | ")[1]});break;case"wredit":o("#modal-webradio-edit").modal(),o.post("/db/?cmd=readradio",{filename:t},function(e){var a=o("#webradio-edit-name");a.val(e.name),a.data("file-name",e.name),o("#webradio-edit-url").val(e.url)},"json");break;case"wrdelete":o("#modal-webradio-delete").modal(),o("#webradio-delete-name").text(t.replace("Webradio/",""));break;case"wrsave":var s=t.split(" | ");o.post("/db/?cmd=addradio",{"radio[label]":s[0],"radio[url]":s[1]});break;default:getDB({cmd:e,path:t,browsemode:GUI.browsemode,querytype:a})}}),o("#webradio-add-button").click(function(){var e=o("#webradio-add-name").val(),a=o("#webradio-add-url").val();""===e||""===a?renderMSG([{title:"Missing fields",text:"Please fill both fields to continue",icon:"fa fa-warning"}]):(o.post("/db/?cmd=addradio",{"radio[label]":e,"radio[url]":a},function(e){},"json"),o("#modal-webradio-add").modal("hide"),o("#webradio-add-name").val(""),o("#webradio-add-url").val(""))}),o("#webradio-edit-button").click(function(){var e=o("#webradio-edit-name");o.post("/db/?cmd=editradio",{"radio[newlabel]":e.val(),"radio[label]":e.data("file-name"),"radio[url]":o("#webradio-edit-url").val()},function(e){},"json")}),o("#webradio-delete-button").click(function(){var e=o("#webradio-delete-name").text();o.post("/db/?cmd=deleteradio",{"radio[label]":e},function(e){},"json")}),o("#db-firstPage").click(function(){o.scrollTo(0,500)}),o("#db-prevPage").click(function(){var e="-="+o(window).height()+"px";o.scrollTo(e,500)}),o("#db-nextPage").click(function(){var e="+="+o(window).height()+"px";o.scrollTo(e,500)}),o("#db-lastPage").click(function(){o.scrollTo("100%",500)}),o("#pl-firstPage").click(function(){o.scrollTo(0,500)}),o("#pl-prevPage").click(function(){var e=o(window).scrollTop()-o(window).height();o.scrollTo(e,500)}),o("#pl-nextPage").click(function(){var e=o(window).scrollTop()+o(window).height();o.scrollTo(e,500)}),o("#pl-lastPage").click(function(){o.scrollTo("100%",500)});var c=document.location.toString();c.match("#")&&o('#menu-bottom a[href="/#'+c.split("#")[1]+'"]').tab("show"),o("#menu-bottom a").on("shown",function(e){history.pushState?history.pushState(null,null,e.target.hash):window.location.hash=e.target.hash}).on("click",function(){o("#overlay-social").hasClass("open")&&o(".overlay-close").trigger("click")}),o(".ttip").length&&o(".ttip").tooltip(),FastClick.attach(document.body),o("#syscmd-poweroff").click(function(){o.post("/settings/",{syscmd:"poweroff"}),toggleLoader()}),o("#syscmd-reboot").click(function(){o.post("/settings/",{syscmd:"reboot"}),toggleLoader()}),o("#syscmd-display_off").click(function(){o.post("/settings/",{syscmd:"display_off"})}),overlayTrigger("#overlay-social"),overlayTrigger("#overlay-playsource"),o("#playsource-mpd").click(function(){o(this).hasClass("inactive")&&(GUI.forceGUIupdate=!0,o.ajax({url:"/command/?switchplayer=MPD",cache:!1}),o("#overlay-playsource-close").trigger("click"))}),o("#playsource-spotify").click(function(){o(this).hasClass("inactive")&&("1"===GUI.libraryhome.Spotify?(GUI.forceGUIupdate=!0,o.ajax({url:"/command/?switchplayer=Spotify",cache:!1}),o("#overlay-playsource-close").trigger("click")):new PNotify({title:"Spotify not enabled",text:"Enable and configure it under the Settings screen",icon:"fa fa-exclamation-circle"}))}),"localhost"==document.location.hostname&&o(".osk-trigger").onScreenKeyboard({draggable:!0})}):(jQuery(document).ready(function(o){"use strict";if(GUI.mode=checkWebSocket(),playbackChannel(),PNotify.prototype.options.styling="fontawesome",PNotify.prototype.options.stack.dir1="up",PNotify.prototype.options.stack.dir2="left",PNotify.prototype.options.stack.firstpos1=90,PNotify.prototype.options.stack.firstpos2=50,PNotify.prototype.options.stack.spacing1=10,PNotify.prototype.options.stack.spacing2=10,notifyChannel(),o(".btn-cmd").click(function(){commandButton(o(this))}),o("#syscmd-poweroff").click(function(){o.post("/settings/",{syscmd:"poweroff"}),toggleLoader()}),o("#syscmd-reboot").click(function(){o.post("/settings/",{syscmd:"reboot"}),toggleLoader()}),o("#syscmd-display_off").click(function(){o.post("/settings/",{syscmd:"display_off"})}),o(".selectpicker").selectpicker(),o("#section-sources").length&&("nfs"===o("#mount-type").val()&&o("#mount-cifs").addClass("disabled").children(".disabler").removeClass("hide"),o("#mount-type").change(function(){"cifs"===o(this).val()||"osx"===o(this).val()?o("#mount-cifs").removeClass("disabled").children(".disabler").addClass("hide"):o("#mount-cifs").addClass("disabled").children(".disabler").removeClass("hide")}),o("#nas-guest").change(function(){o(this).prop("checked")?o("#mount-auth").addClass("disabled").children(".disabler").removeClass("hide"):o("#mount-auth").removeClass("disabled").children(".disabler").addClass("hide")}),o("#nas-advanced").change(function(){o(this).prop("checked")?o("#mount-advanced-config").removeClass("hide"):o("#mount-advanced-config").addClass("hide")}),o("#show-mount-advanced-config").click(function(e){e.preventDefault(),o(this).hasClass("active")?(o("#mount-advanced-config").toggleClass("hide"),o(this).removeClass("active"),o(this).find("i").removeClass("fa fa-minus-circle").addClass("fa fa-plus-circle"),o(this).find("span").html("show advanced options")):(o("#mount-advanced-config").toggleClass("hide"),o(this).addClass("active"),o(this).find("i").removeClass("fa fa-plus-circle").addClass("fa fa-minus-circle"),o(this).find("span").html("hide advanced options"))}),o("#usb-mount-list a").click(function(){var e=o(this).data("mount");o("#usb-umount-name").html(e),o("#usb-umount").val(e)})),o("#section-settings").length&&(o("#airplay").change(function(){o(this).prop("checked")?(o("#airplayName").removeClass("hide"),o("#airplayBox").addClass("boxed-group")):(o("#airplayName").addClass("hide"),o("#airplayBox").removeClass("boxed-group"))}),o("#scrobbling-lastfm").change(function(){o(this).prop("checked")?(o("#lastfmAuth").removeClass("hide"),o("#lastfmBox").addClass("boxed-group")):(o("#lastfmAuth").addClass("hide"),o("#lastfmBox").removeClass("boxed-group"))}),o("#proxy").change(function(){o(this).prop("checked")?(o("#proxyAuth").removeClass("hide"),o("#proxyBox").addClass("boxed-group")):(o("#proxyAuth").addClass("hide"),o("#proxyBox").removeClass("boxed-group"))}),o("#dlna").change(function(){o(this).prop("checked")?(o("#dlnaName").removeClass("hide"),o("#dlnaBox").addClass("boxed-group")):(o("#dlnaName").addClass("hide"),o("#dlnaBox").removeClass("boxed-group"))}),o("#dlnaTidal").change(function(){o(this).prop("checked")?(o("#dlnaTidalName").removeClass("hide"),o("#dlnaTidalBox").addClass("boxed-group")):(o("#dlnaTidalName").addClass("hide"),o("#dlnaTidalBox").removeClass("boxed-group"))}),o("#dlnaGoogle").change(function(){o(this).prop("checked")?(o("#dlnaGoogleName").removeClass("hide"),o("#dlnaGoogleBox").addClass("boxed-group")):(o("#dlnaGoogleName").addClass("hide"),o("#dlnaGoogleBox").removeClass("boxed-group"))}),o("#dlnaQobuz").change(function(){o(this).prop("checked")?(o("#dlnaQobuzName").removeClass("hide"),o("#dlnaQobuzBox").addClass("boxed-group")):(o("#dlnaQobuzName").addClass("hide"),o("#dlnaQobuzBox").removeClass("boxed-group"))}),o("#spotify").change(function(){o(this).prop("checked")?(o("#spotifyAuth").removeClass("hide"),o("#spotifyBox").addClass("boxed-group")):(o("#spotifyAuth").addClass("hide"),o("#spotifyBox").removeClass("boxed-group"))}),o("#samba").change(function(){o(this).prop("checked")?(o("#sambaAuth").removeClass("hide"),o("#sambaBox").addClass("boxed-group")):(o("#sambaAuth").addClass("hide"),o("#sambaBox").removeClass("boxed-group"))}),o("#bluetooth").change(function(){o(this).prop("checked")?(o("#bluetoothAuth").removeClass("hide"),o("#bluetoothBox").addClass("boxed-group")):(o("#bluetoothAuth").addClass("hide"),o("#bluetoothBox").removeClass("boxed-group"))}),o(".btn-file :file").on("fileselect",function(e,a,t){var s=o(this).parents(".input-group").find(":text");s.length?s.val(t):t&&(console.log("Selected file: ",t),-1<t.indexOf("backup_")&&-1<t.indexOf(".tar.gz")?(o("#backup-file").html(' <i class="fa fa-check dx green"></i> '+t),o("#btn-backup-upload").prop("disabled",!1)):(o("#backup-file").html(' <i class="fa fa-times dx red"></i> not a valid backup file'),o("#btn-backup-upload").prop("disabled",!0)))})),o("#section-network").length){var e=o("#network-manual-config");"0"===o("#dhcp").val()&&e.removeClass("hide"),o("#dhcp").change(function(){"0"===o(this).val()?e.removeClass("hide"):e.addClass("hide")});var a=o("#wifi-security-key");"open"!==o("#wifi-security").val()&&a.removeClass("hide"),o("#wifi-security").change(function(){"open"!==o(this).val()?a.removeClass("hide"):a.addClass("hide")}),o("#wifiNetworks").length&&(wlansChannel(),nicsChannel()),o("#wifiProfiles").change(function(){o(this).prop("checked")?o("#wifiProfilesBox").addClass("hide"):o("#wifiProfilesBox").removeClass("hide")})}if(o("#section-accesspoint").length&&(o("#accesspoint").change(function(){o(this).prop("checked")?(o("#accesspointSettings").removeClass("hide"),o("#accesspointBox").addClass("boxed-group")):(o("#accesspointSettings").addClass("hide"),o("#accesspointBox").removeClass("boxed-group"))}),o("#ip-address").change(function(){var e=o("#ip-address").val().split(".");e[3]++,o("#dhcp-range").val(e.join(".")+","+e[0]+"."+e[1]+"."+e[2]+".254,24h"),e[3]=255,o("#broadcast").val(e.join(".")),o("#dhcp-option-dns").val(o("#ip-address").val()),o("#dhcp-option-router").val(o("#ip-address").val())})),o("#section-mpd").length&&(o("#audio-output-interface").change(function(){renderMSG([{title:"Switching audio output",text:"Please wait for the config update...",icon:"fa fa-cog fa-spin",delay:5e3}]);var e=o(this).val();o.ajax({type:"POST",url:"/mpd/",data:{ao:e},cache:!1})}),o(".manual-edit-confirm").find(".btn-primary").click(function(){o("#mpdconf_editor").removeClass("hide"),o("#manual-edit-warning").addClass("hide")})),o("#section-debug").length){ZeroClipboard.config({swfPath:"/assets/js/vendor/ZeroClipboard.swf"});var t=new ZeroClipboard(document.getElementById("copy-to-clipboard"));t.on("ready",function(e){t.on("aftercopy",function(e){new PNotify({title:"Copied to clipboard",text:"The debug output was copied successfully in your clipboard.",icon:"fa fa-check"})})})}"localhost"==document.location.hostname&&o(".osk-trigger").onScreenKeyboard({draggable:!0})}),$(document).on("change",".btn-file :file",function(){var e=$(this),a=e.get(0).files?e.get(0).files.length:1,t=e.val().replace(/\\/g,"/").replace(/.*\//,"");e.trigger("fileselect",[a,t])}));