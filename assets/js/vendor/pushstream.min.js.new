!function(t,e,n){"use strict";if(!t.PushStream){var s={},i=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],r=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],o=function(t){return(10>t?"0":"")+t};s.dateToUTCString=function(t){var e=o(t.getUTCHours())+":"+o(t.getUTCMinutes())+":"+o(t.getUTCSeconds());return i[t.getUTCDay()]+", "+o(t.getUTCDate())+" "+r[t.getUTCMonth()]+" "+t.getUTCFullYear()+" "+e+" GMT"};var a=function(){for(var t=arguments[0]||{},e=0;e<arguments.length;e++){var n=arguments[e];for(var s in n)(!n.hasOwnProperty||n.hasOwnProperty(s))&&(t[s]=n[s])}return t},c=/^[\],:{}\s]*$/,h=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,u=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,l=/(?:^|:|,)(?:\s*\[)+/g,m=function(t){return t.replace(/^\s*/,"").replace(/\s*$/,"")};s.parseJSON=function(e){if(!e||!v(e))return null;if(e=m(e),t.JSON&&t.JSON.parse)try{return t.JSON.parse(e)}catch(n){throw"Invalid JSON: "+e}if(c.test(e.replace(h,"@").replace(u,"]").replace(l,"")))return new Function("return "+e)();throw"Invalid JSON: "+e};var d=function(t){var e={};return e[t.tagArgument]="",e[t.timeArgument]="",e[t.eventIdArgument]="",t.messagesControlByArgument&&(e[t.tagArgument]=Number(t._etag),t._lastModified?e[t.timeArgument]=t._lastModified:t._lastEventId&&(e[t.eventIdArgument]=t._lastEventId)),e},p=function(){return(new Date).getTime()},g=function(){return{_:p()}},f=function(e){var n=e;if("object"==typeof e){n="";for(var s in e)(!e.hasOwnProperty||e.hasOwnProperty(s))&&(n+="&"+s+"="+t.escape(e[s]));n=n.substring(1)}return n||""},_=function(t,e){return t+(t.indexOf("?")<0?"?":"&")+f(e)},y=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},v=function(t){return"[object String]"===Object.prototype.toString.call(t)},S=function(t){return"[object Date]"===Object.prototype.toString.call(t)},b={logger:null,debug:function(){"debug"===K.LOG_LEVEL&&b._log.apply(b._log,arguments)},info:function(){("info"===K.LOG_LEVEL||"debug"===K.LOG_LEVEL)&&b._log.apply(b._log,arguments)},error:function(){b._log.apply(b._log,arguments)},_initLogger:function(){var e=t.console;e&&e.log&&(e.log.apply?b.logger=e.log:"object"==typeof e.log&&Function.prototype.bind?b.logger=Function.prototype.bind.call(e.log,e):"object"==typeof e.log&&Function.prototype.call&&(b.logger=function(){Function.prototype.call.call(e.log,e,Array.prototype.slice.call(arguments))}))},_log:function(){if(b.logger||b._initLogger(),b.logger)try{b.logger.apply(t.console,arguments)}catch(n){b._initLogger(),b.logger&&b.logger.apply(t.console,arguments)}var s=e.getElementById(K.LOG_OUTPUT_ELEMENT_ID);if(s){for(var i="",r=0;r<arguments.length;r++)i+=arguments[r]+" ";s.innerHTML+=i+"\n";var o=s.innerHTML.split("\n");o.length>100&&(s.innerHTML=o.slice(-100).join("\n"))}}},C={_getXHRObject:function(e){var n=!1;if(e){try{n=new t.XDomainRequest}catch(s){}if(n)return n}try{n=new t.XMLHttpRequest}catch(i){try{n=new t.ActiveXObject("Msxml2.XMLHTTP")}catch(r){try{n=new t.ActiveXObject("Microsoft.XMLHTTP")}catch(o){n=!1}}}return n},_send:function(e,n){e=e||{},e.timeout=e.timeout||3e4;var s=C._getXHRObject(e.crossDomain);if(s&&e.url){C.clear(e),e.xhr=s,t.XDomainRequest&&s instanceof t.XDomainRequest?(s.onload=function(){e.afterReceive&&e.afterReceive(s),e.success&&e.success(s.responseText)},s.onerror=s.ontimeout=function(){e.afterReceive&&e.afterReceive(s),e.error&&e.error(s.status)}):s.onreadystatechange=function(){4===s.readyState&&(C.clear(e),e.afterReceive&&e.afterReceive(s),200===s.status?e.success&&e.success(s.responseText):e.error&&e.error(s.status))},e.beforeOpen&&e.beforeOpen(s);var i={},r=null,o="GET";n?(r=f(e.data),o="POST"):i=e.data||{},s.open(o,_(e.url,a({},i,g())),!0),e.beforeSend&&e.beforeSend(s);var c=function(){C.clear(e);try{s.abort()}catch(t){}e.error(304)};return n?s.setRequestHeader&&(s.setRequestHeader("Accept","application/json"),s.setRequestHeader("Content-type","application/x-www-form-urlencoded")):e.timeoutId=t.setTimeout(c,e.timeout+2e3),s.send(r),s}},_clear_xhr:function(t){t&&(t.onreadystatechange=null)},_clear_script:function(t){t&&(t.onerror=t.onload=t.onreadystatechange=null,t.parentNode&&t.parentNode.removeChild(t))},_clear_timeout:function(t){t.timeoutId=A(t.timeoutId)},_clear_jsonp:function(e){var n=e.data.callback;n&&(t[n]=function(){t[n]=null})},clear:function(t){C._clear_timeout(t),C._clear_jsonp(t),C._clear_script(e.getElementById(t.scriptId)),C._clear_xhr(t.xhr)},jsonp:function(n){n.timeout=n.timeout||3e4,C.clear(n);var s=e.head||e.getElementsByTagName("head")[0],i=e.createElement("script"),r=p(),o=function(){C.clear(n);var t=p();n.error(t-r>n.timeout/2?304:403)},c=function(){C.clear(n),n.load()},h=function(){n.afterSuccess=!0,n.success.apply(null,arguments)};return i.onerror=o,i.onload=i.onreadystatechange=function(t){(!i.readyState||/loaded|complete/.test(i.readyState))&&(n.afterSuccess?c():o())},n.beforeOpen&&n.beforeOpen({}),n.beforeSend&&n.beforeSend({}),n.timeoutId=t.setTimeout(o,n.timeout+2e3),n.scriptId=n.scriptId||p(),n.afterSuccess=null,n.data.callback=n.scriptId+"_onmessage_"+p(),t[n.data.callback]=h,i.setAttribute("src",_(n.url,a({},n.data,g()))),i.setAttribute("async","async"),i.setAttribute("id",n.scriptId),s.insertBefore(i,s.firstChild),n},load:function(t){return C._send(t,!1)},post:function(t){return C._send(t,!0)}},T=function(e){return e?t.escape(e):""},E=function(e){return e?t.unescape(e):""};s.parseMessage=function(t,e){var n=t;v(t)&&(n=s.parseJSON(t));var i={id:n[e.jsonIdKey],channel:n[e.jsonChannelKey],text:v(n[e.jsonTextKey])?E(n[e.jsonTextKey]):n[e.jsonTextKey],tag:n[e.jsonTagKey],time:n[e.jsonTimeKey],eventid:n[e.jsonEventIdKey]||""};return i};var P=function(t){return t.backtrack?".b"+Number(t.backtrack):""},w=function(t,e){var n="";for(var s in t)(!t.hasOwnProperty||t.hasOwnProperty(s))&&(n+="/"+s+(e?P(t[s]):""));return n},I=function(t,e,n,s){var i=t.wrapper.type===k.TYPE,r=t.useSSL,o=x(r,t.port),c=i?r?"wss://":"ws://":r?"https://":"http://";c+=t.host,c+=o?":"+o:"",c+=e;var h=w(t.channels,s);if(t.channelsByArgument){var u={};u[t.channelsArgument]=h.substring(1),n=a({},n,u)}else c+=h;return _(c,n)},O=function(t){var e=x(t.useSSL,t.port),n=t.useSSL?"https://":"http://";return n+=t.host,n+=e?":"+e:"",n+=t.urlPrefixPublisher,n+="?id="+w(t.channels,!1)};s.extract_xss_domain=function(t){if(t.match(/^(\d{1,3}\.){3}\d{1,3}$/))return t;var e=t.split("."),n=Math.max(e.length-1,t.match(/(\w{4,}\.\w{2}|\.\w{3,})$/)?2:3);return e.slice(-1*n).join(".")};var x=function(t,e){return e=Number(e||(t?443:80)),!t&&80===e||t&&443===e?"":e};s.isCrossDomainUrl=function(n){if(!n)return!1;var s=e.createElement("a");s.href=n;var i=x("https:"===t.location.protocol,t.location.port),r=x("https:"===s.protocol,s.port);return t.location.protocol!==s.protocol||t.location.hostname!==s.hostname||i!==r};var L=function(t,e){return function(){return t.apply(e,arguments)}},A=function(e){return e&&t.clearTimeout(e),null},N=function(t){b.info("["+this.type+"] message received",arguments);var e=s.parseMessage(t.data,this.pushstream);e.tag&&(this.pushstream._etag=e.tag),e.time&&(this.pushstream._lastModified=e.time),e.eventid&&(this.pushstream._lastEventId=e.eventid),this.pushstream._onmessage(e.text,e.id,e.channel,e.eventid,!0,e.time)},M=function(){this.pushstream._onopen(),b.info("["+this.type+"] connection opened")},j=function(e){b.info("["+this.type+"] error (disconnected by server):",e),(this.pushstream.readyState!==K.OPEN||this.type!==D.TYPE||"error"!==e.type||this.connection.readyState!==t.EventSource.CONNECTING)&&(this._closeCurrentConnection(),this.pushstream._onerror({type:e&&("load"===e.type||"close"===e.type&&1006===e.code)||this.pushstream.readyState===K.CONNECTING?"load":"timeout"}))},k=function(e){if(!t.WebSocket&&!t.MozWebSocket)throw"WebSocket not supported";this.type=k.TYPE,this.pushstream=e,this.connection=null};k.TYPE="WebSocket",k.prototype={connect:function(){this._closeCurrentConnection();var e=a({},this.pushstream.extraParams(),g(),d(this.pushstream)),n=I(this.pushstream,this.pushstream.urlPrefixWebsocket,e,!this.pushstream._useControlArguments());this.connection=t.WebSocket?new t.WebSocket(n):new t.MozWebSocket(n),this.connection.onerror=L(j,this),this.connection.onclose=L(j,this),this.connection.onopen=L(M,this),this.connection.onmessage=L(N,this),b.info("[WebSocket] connecting to:",n)},disconnect:function(){this.connection&&(b.debug("[WebSocket] closing connection to:",this.connection.url),this.connection.onclose=null,this._closeCurrentConnection(),this.pushstream._onclose())},_closeCurrentConnection:function(){if(this.connection){try{this.connection.close()}catch(t){}this.connection=null}},sendMessage:function(t){this.connection&&this.connection.send(t)}};var D=function(e){if(!t.EventSource)throw"EventSource not supported";this.type=D.TYPE,this.pushstream=e,this.connection=null};D.TYPE="EventSource",D.prototype={connect:function(){this._closeCurrentConnection();var e=a({},this.pushstream.extraParams(),g(),d(this.pushstream)),n=I(this.pushstream,this.pushstream.urlPrefixEventsource,e,!this.pushstream._useControlArguments());this.connection=new t.EventSource(n),this.connection.onerror=L(j,this),this.connection.onopen=L(M,this),this.connection.onmessage=L(N,this),b.info("[EventSource] connecting to:",n)},disconnect:function(){this.connection&&(b.debug("[EventSource] closing connection to:",this.connection.url),this.connection.onclose=null,this._closeCurrentConnection(),this.pushstream._onclose())},_closeCurrentConnection:function(){if(this.connection){try{this.connection.close()}catch(t){}this.connection=null}}};var R=function(t){this.type=R.TYPE,this.pushstream=t,this.connection=null,this.url=null,this.frameloadtimer=null,this.pingtimer=null,this.iframeId="PushStreamManager_"+t.id};R.TYPE="Stream",R.prototype={connect:function(){this._closeCurrentConnection();var t=s.extract_xss_domain(this.pushstream.host);try{e.domain=t}catch(n){b.error("[Stream] (warning) problem setting document.domain = "+t+" (OBS: IE8 does not support set IP numbers as domain)")}var i=a({},this.pushstream.extraParams(),g(),{streamid:this.pushstream.id},d(this.pushstream));this.url=I(this.pushstream,this.pushstream.urlPrefixStream,i,!this.pushstream._useControlArguments()),b.debug("[Stream] connecting to:",this.url),this.loadFrame(this.url)},disconnect:function(){this.connection&&(b.debug("[Stream] closing connection to:",this.url),this._closeCurrentConnection(),this.pushstream._onclose())},_clear_iframe:function(){var t=e.getElementById(this.iframeId);t&&(t.onload=null,t.src="about:blank",t.parentNode&&t.parentNode.removeChild(t))},_closeCurrentConnection:function(){this._clear_iframe(),this.connection&&(this.pingtimer=A(this.pingtimer),this.frameloadtimer=A(this.frameloadtimer),this.connection=null,this.transferDoc=null,"function"==typeof t.CollectGarbage&&t.CollectGarbage())},loadFrame:function(n){this._clear_iframe();var s=null;if("ActiveXObject"in t){var i=new t.ActiveXObject("htmlfile");i.open(),i.write("<html><script>document.domain='"+e.domain+"';</script>"),i.write("<body><iframe id='"+this.iframeId+"' src='"+n+"'></iframe></body></html>"),i.parentWindow.PushStream=K,i.close(),s=i.getElementById(this.iframeId),this.transferDoc=i}else s=e.createElement("IFRAME"),s.style.width="1px",s.style.height="1px",s.style.border="none",s.style.position="absolute",s.style.top="-10px",s.style.marginTop="-10px",s.style.zIndex="-20",s.PushStream=K,e.body.appendChild(s),s.setAttribute("src",n),s.setAttribute("id",this.iframeId);s.onload=L(j,this),this.connection=s,this.frameloadtimer=t.setTimeout(L(j,this),this.pushstream.timeout)},register:function(t){this.frameloadtimer=A(this.frameloadtimer),t.p=L(this.process,this),this.connection.onload=L(this._onframeloaded,this),this.pushstream._onopen(),this.setPingTimer(),b.info("[Stream] frame registered")},process:function(t,e,n,s,i,r){this.pingtimer=A(this.pingtimer),b.info("[Stream] message received",arguments),-1!==t&&(r&&(this.pushstream._etag=r),i&&(this.pushstream._lastModified=i),s&&(this.pushstream._lastEventId=s)),this.pushstream._onmessage(E(n),t,e,s||"",!0,i),this.setPingTimer()},_onframeloaded:function(){b.info("[Stream] frame loaded (disconnected by server)"),this.pushstream._onerror({type:"timeout"}),this.connection.onload=null,this.disconnect()},setPingTimer:function(){this.pingtimer&&A(this.pingtimer),this.pingtimer=t.setTimeout(L(j,this),this.pushstream.pingtimeout)}};var B=function(t){this.type=B.TYPE,this.pushstream=t,this.connection=null,this.opentimer=null,this.messagesQueue=[],this._linkedInternalListen=L(this._internalListen,this),this.xhrSettings={timeout:this.pushstream.timeout,data:{},url:null,success:L(this.onmessage,this),error:L(this.onerror,this),load:L(this.onload,this),beforeSend:L(this.beforeSend,this),afterReceive:L(this.afterReceive,this)}};B.TYPE="LongPolling",B.prototype={connect:function(){this.messagesQueue=[],this._closeCurrentConnection(),this.urlWithBacktrack=I(this.pushstream,this.pushstream.urlPrefixLongpolling,{},!0),this.urlWithoutBacktrack=I(this.pushstream,this.pushstream.urlPrefixLongpolling,{},!1),this.xhrSettings.url=this.urlWithBacktrack,this.useJSONP=this.pushstream._crossDomain||this.pushstream.useJSONP,this.xhrSettings.scriptId="PushStreamManager_"+this.pushstream.id,this.useJSONP&&(this.pushstream.messagesControlByArgument=!0),this._listen(),this.opentimer=t.setTimeout(L(M,this),150),b.info("[LongPolling] connecting to:",this.xhrSettings.url)},_listen:function(){this._internalListenTimeout&&A(this._internalListenTimeout),this._internalListenTimeout=t.setTimeout(this._linkedInternalListen,100)},_internalListen:function(){this.pushstream._keepConnected&&(this.xhrSettings.url=this.pushstream._useControlArguments()?this.urlWithoutBacktrack:this.urlWithBacktrack,this.xhrSettings.data=a({},this.pushstream.extraParams(),this.xhrSettings.data,d(this.pushstream)),this.useJSONP?this.connection=C.jsonp(this.xhrSettings):this.connection||(this.connection=C.load(this.xhrSettings)))},disconnect:function(){this.connection&&(b.debug("[LongPolling] closing connection to:",this.xhrSettings.url),this._closeCurrentConnection(),this.pushstream._onclose())},_closeCurrentConnection:function(){if(this.opentimer=A(this.opentimer),this.connection){try{this.connection.abort()}catch(t){try{C.clear(this.connection)}catch(e){}}this.connection=null,this.xhrSettings.url=null}},beforeSend:function(t){this.pushstream.messagesControlByArgument||(t.setRequestHeader("If-None-Match",this.pushstream._etag),t.setRequestHeader("If-Modified-Since",this.pushstream._lastModified))},afterReceive:function(t){this.pushstream.messagesControlByArgument||(this.pushstream._etag=t.getResponseHeader("Etag"),this.pushstream._lastModified=t.getResponseHeader("Last-Modified")),this.connection=null},onerror:function(t){this._closeCurrentConnection(),this.pushstream._keepConnected&&(304===t?this._listen():(b.info("[LongPolling] error (disconnected by server):",t),this.pushstream._onerror({type:403===t||this.pushstream.readyState===K.CONNECTING?"load":"timeout"})))},onload:function(){this._listen()},onmessage:function(t){this._internalListenTimeout&&A(this._internalListenTimeout),b.info("[LongPolling] message received",t);for(var e=null,n=y(t)?t:t.replace(/\}\{/g,"}\r\n{").split("\r\n"),i=0;i<n.length;i++)n[i]&&(e=s.parseMessage(n[i],this.pushstream),this.messagesQueue.push(e),this.pushstream.messagesControlByArgument&&e.time&&(this.pushstream._etag=e.tag,this.pushstream._lastModified=e.time));for(this._listen();this.messagesQueue.length>0;){var r=this.messagesQueue.shift();this.pushstream._onmessage(r.text,r.id,r.channel,r.eventid,0===this.messagesQueue.length,r.time)}}};var U=[],K=function(e){e=e||{},this.id=U.push(this)-1,this.useSSL=e.useSSL||!1,this.host=e.host||t.location.hostname,this.port=Number(e.port||(this.useSSL?443:80)),this.timeout=e.timeout||3e4,this.pingtimeout=e.pingtimeout||3e4,this.reconnectOnTimeoutInterval=e.reconnectOnTimeoutInterval||3e3,this.reconnectOnChannelUnavailableInterval=e.reconnectOnChannelUnavailableInterval||6e4,this.autoReconnect=e.autoReconnect!==!1,this.lastEventId=e.lastEventId||null,this.messagesPublishedAfter=e.messagesPublishedAfter,this.messagesControlByArgument=e.messagesControlByArgument||!1,this.tagArgument=e.tagArgument||"tag",this.timeArgument=e.timeArgument||"time",this.eventIdArgument=e.eventIdArgument||"eventid",this.useJSONP=e.useJSONP||!1,this._reconnecttimer=null,this._etag=0,this._lastModified=null,this._lastEventId=null,this.urlPrefixPublisher=e.urlPrefixPublisher||"/pub",this.urlPrefixStream=e.urlPrefixStream||"/sub",this.urlPrefixEventsource=e.urlPrefixEventsource||"/ev",this.urlPrefixLongpolling=e.urlPrefixLongpolling||"/lp",this.urlPrefixWebsocket=e.urlPrefixWebsocket||"/ws",this.jsonIdKey=e.jsonIdKey||"id",this.jsonChannelKey=e.jsonChannelKey||"channel",this.jsonTextKey=e.jsonTextKey||"text",this.jsonTagKey=e.jsonTagKey||"tag",this.jsonTimeKey=e.jsonTimeKey||"time",this.jsonEventIdKey=e.jsonEventIdKey||"eventid",this.modes=(e.modes||"eventsource|websocket|stream|longpolling").split("|"),this.wrappers=[],this.wrapper=null,this.onchanneldeleted=e.onchanneldeleted||null,this.onmessage=e.onmessage||null,this.onerror=e.onerror||null,this.onstatuschange=e.onstatuschange||null,this.extraParams=e.extraParams||function(){return{}},this.channels={},this.channelsCount=0,this.channelsByArgument=e.channelsByArgument||!1,this.channelsArgument=e.channelsArgument||"channels",this._crossDomain=s.isCrossDomainUrl(O(this));for(var n=0;n<this.modes.length;n++)try{var i=null;switch(this.modes[n]){case"websocket":i=new k(this);break;case"eventsource":i=new D(this);break;case"longpolling":i=new B(this);break;case"stream":i=new R(this)}this.wrappers[this.wrappers.length]=i}catch(r){b.info(r)}this.readyState=0};K.LOG_LEVEL="error",K.LOG_OUTPUT_ELEMENT_ID="Log4jsLogOutput",K.CLOSED=0,K.CONNECTING=1,K.OPEN=2,K.prototype={addChannel:function(t,e){if(T(t)!==t)throw"Invalid channel name! Channel has to be a set of [a-zA-Z0-9]";if(b.debug("entering addChannel"),"undefined"!=typeof this.channels[t])throw"Cannot add channel "+t+": already subscribed";e=e||{},b.info("adding channel",t,e),this.channels[t]=e,this.channelsCount++,this.readyState!==K.CLOSED&&this.connect(),b.debug("leaving addChannel")},removeChannel:function(t){this.channels[t]&&(b.info("removing channel",t),delete this.channels[t],this.channelsCount--)},removeAllChannels:function(){b.info("removing all channels"),this.channels={},this.channelsCount=0},_setState:function(t){this.readyState!==t&&(b.info("status changed",t),this.readyState=t,this.onstatuschange&&this.onstatuschange(this.readyState))},connect:function(){if(b.debug("entering connect"),!this.host)throw"PushStream host not specified";if(isNaN(this.port))throw"PushStream port not specified";if(!this.channelsCount)throw"No channels specified";if(0===this.wrappers.length)throw"No available support for this browser";this._keepConnected=!0,this._lastUsedMode=0,this._connect(),b.debug("leaving connect")},disconnect:function(){b.debug("entering disconnect"),this._keepConnected=!1,this._disconnect(),this._setState(K.CLOSED),b.info("disconnected"),b.debug("leaving disconnect")},_useControlArguments:function(){return this.messagesControlByArgument&&(null!==this._lastModified||null!==this._lastEventId)},_connect:function(){if(null===this._lastEventId&&(this._lastEventId=this.lastEventId),null===this._lastModified){var t=this.messagesPublishedAfter;if(!S(t)){var e=Number(this.messagesPublishedAfter);e>0?(t=new Date,t.setTime(t.getTime()-1e3*e)):0>e&&(t=new Date(0))}S(t)&&(this._lastModified=s.dateToUTCString(t))}this._disconnect(),this._setState(K.CONNECTING),this.wrapper=this.wrappers[this._lastUsedMode++%this.wrappers.length];try{this.wrapper.connect()}catch(n){this.wrapper&&this.wrapper.disconnect()}},_disconnect:function(){this._reconnecttimer=A(this._reconnecttimer),this.wrapper&&this.wrapper.disconnect()},_onopen:function(){this._reconnecttimer=A(this._reconnecttimer),this._setState(K.OPEN),this._lastUsedMode>0&&this._lastUsedMode--},_onclose:function(){this._reconnecttimer=A(this._reconnecttimer),this._setState(K.CLOSED),this._reconnect(this.reconnectOnTimeoutInterval)},_onmessage:function(t,e,n,s,i,r){b.debug("message",t,e,n,s,i,r),-2===e?this.onchanneldeleted&&this.onchanneldeleted(n):e>0&&this.onmessage&&this.onmessage(t,e,n,s,i,r)},_onerror:function(t){this._setState(K.CLOSED),this._reconnect("timeout"===t.type?this.reconnectOnTimeoutInterval:this.reconnectOnChannelUnavailableInterval),this.onerror&&this.onerror(t)},_reconnect:function(e){this.autoReconnect&&this._keepConnected&&!this._reconnecttimer&&this.readyState!==K.CONNECTING&&(b.info("trying to reconnect in",e),this._reconnecttimer=t.setTimeout(L(this._connect,this),e))},sendMessage:function(t,e,n){t=T(t),this.wrapper.type===k.TYPE?(this.wrapper.sendMessage(t),e&&e()):C.post({url:O(this),data:t,success:e,error:n,crossDomain:this._crossDomain})}},K.sendMessage=function(t,e,n,s){C.post({url:t,data:T(e),success:n,error:s})},K.register=function(t){var e=t.window.location.href.match(/streamid=([0-9]*)&?/);e[1]&&U[e[1]]&&U[e[1]].wrapper.register(t)},K.unload=function(){for(var t=0;t<U.length;t++)try{U[t].disconnect()}catch(e){}},t.PushStream=K,t.PushStreamManager=U,t.attachEvent&&t.attachEvent("onunload",K.unload),t.addEventListener&&t.addEventListener.call(t,"unload",K.unload,!1)}}(window,document);